
        <!DOCTYPE html>
         <html lang="en">
         <head>
	     <meta charset="UTF-8">
         <meta name="keywords" content="vue源码,博客,前端"/>
         <meta name="description" content="vue-route、vuex、vue的相关重要源码点笔记"/>
         <!--<meta http-equiv="content-security-policy" content="default-src self"/>-->
	     <title>vue源码</title>
        </head>
        <link rel="stylesheet" href="../main.css">
        <body>
        <div class="message_box"></div>
        <div class="content">
           <div id="view">
              <div>
                <div class="bs_content">
                   <h3 id='Vue-Router源码' class='BE987642'>Vue-Router源码</h3><div><div class='quote'><span class="highlight">vue-router</span>其实就是<span class="highlight">一个插件</span>,<span class="highlight">vue通过use去使用</span></div></div><div><div class='quote'>所以<span class="highlight">插件</span>如何去<span class="highlight">实现</span>,<span class="highlight">Vue使用插件</span>时会<span class="highlight">通过Vue.use(插件类)</span>,<span class="highlight">use方法内部</span>会<span class="highlight">调用</span>插件<span class="highlight">类身上的install静态方法</span>,<span class="highlight">并且把Vue对象作为实参传了过来</span></div></div><div><div class='quote'>我们如何使用,如下:</div></div><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div style='height: 14px;'></div><div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div><div class='index'>19.</div><div class='index'>20.</div><div class='index'>21.</div><div class='index'>22.</div><div class='index'>23.</div><div class='index'>24.</div><div class='index'>25.</div><div class='index'>26.</div><div class='index'>27.</div><div class='index'>28.</div><div class='index'>29.</div><div class='index'>30.</div><div class='index'>31.</div><div class='index'>32.</div><div class='index'>33.</div><div class='index'>34.</div><div class='index'>35.</div><div class='index'>36.</div><div class='index'>37.</div><div class='index'>38.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//第一步，引入VueRouter插件</span></code><code data-key='xmp'><span class="let">import </span>VueRouter<span class="let"> from </span><span class="string">"vue-router"</span>;</code><code data-key='xmp'><span class="let">import </span>Vue<span class="let"> from </span><span class="string">"vue"</span>;</code><code data-key='xmp'> </code><code data-key='xmp'><span class="green">//调用Vue<span class="log">.</span><span class="title1">use</span>触发VueRouter类身上的install方法</span></code><code data-key='xmp'>Vue<span class="log">.</span><span class="title1">use</span><span class="log">(</span>VueRouter<span class="log">)</span>;</code><code data-key='xmp'> </code><code data-key='xmp'><span class="green">//定义一个routes数组容器,装一些路由信息</span></code><code data-key='xmp'><span class="let">const </span>routes <span class="let">=</span> [</code><code data-key='xmp'>  <span class="log">{</span></code><code data-key='xmp'>    path: <span class="string">"/home"</span>,</code><code data-key='xmp'>    component: <span class="log">{</span></code><code data-key='xmp'>      <span class="title">render<span class="log">(</span></span>h<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>        <span class="let">return</span> <span class="title">h<span class="log">(</span></span><span class="string">"div"</span>,<span class="string">"this is home component"</span><span class="log">)</span>;</code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>    <span class="log">}</span>,</code><code data-key='xmp'>    name: <span class="string">"Home"</span></code><code data-key='xmp'>  <span class="log">}</span>,</code><code data-key='xmp'>  <span class="log">{</span></code><code data-key='xmp'>    path: <span class="string">"/about"</span>,</code><code data-key='xmp'>    component: <span class="log">{</span></code><code data-key='xmp'>      <span class="title">render<span class="log">(</span></span>h<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>        <span class="let">return</span> <span class="title">h<span class="log">(</span></span><span class="string">"div"</span>,<span class="string">"this is about component"</span><span class="log">)</span>;</code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>];</code><code data-key='xmp'><span class="green">//实例VueRouter,传一个对象,对象中主要有两个参数,mode和routes<span class="log"> => </span>就是上一步定义赋值的routes,最后导出</span></code><code data-key='xmp'> </code><code data-key='xmp'><span class="let">export default</span><span class="let"> new </span><span class="title">VueRouter<span class="log">(</span></span><span class="log">{</span></code><code data-key='xmp'>  routes,</code><code data-key='xmp'>  mode: <span class="string">"hash"</span> <span class="green">//有两种模式: history和hash</span></code><code data-key='xmp'><span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'> </code><code data-key='xmp'><span class="green">//最后一步,在入口main<span class="log">.</span><span class="title1">js</span>文件中引入路由实例对象,在root身上挂载router</span></code><code data-key='xmp'>Vue<span class="log">.</span><span class="title1">createApp</span><span class="log">(</span><span class="log">{</span></code><code data-key='xmp'>  router</code><code data-key='xmp'><span class="log">}</span><span class="log">)</span><span class="log">.</span><span class="title1">mount</span><span class="log">(</span><span class="string">"#app"</span><span class="log">)</span>;</code></div></pre><div><div class='quote'>然后使用就通过router-link和router-view使用,这其实就是两个组件</div></div><div><div class='quote'>从源码的角度去分析上面部分是如何实现的,首先肯定是有一个VueRouter的类,而且身上有一个install的静态方法,接口一个options的参数,options里面装有路由的模式和路由信息routes,所以源码如下: </div></div><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div><div class='index'>19.</div><div class='index'>20.</div><div class='index'>21.</div><div class='index'>22.</div><div class='index'>23.</div><div class='index'>24.</div><div class='index'>25.</div><div class='index'>26.</div><div class='index'>27.</div><div class='index'>28.</div><div class='index'>29.</div><div class='index'>30.</div><div class='index'>31.</div><div class='index'>32.</div><div class='index'>33.</div><div class='index'>34.</div><div class='index'>35.</div><div class='index'>36.</div><div class='index'>37.</div><div class='index'>38.</div><div class='index'>39.</div><div class='index'>40.</div><div class='index'>41.</div><div class='index'>42.</div><div class='index'>43.</div><div class='index'>44.</div><div class='index'>45.</div><div class='index'>46.</div><div class='index'>47.</div><div class='index'>48.</div><div class='index'>49.</div><div class='index'>50.</div><div class='index'>51.</div><div class='index'>52.</div><div class='index'>53.</div><div class='index'>54.</div><div class='index'>55.</div><div class='index'>56.</div><div class='index'>57.</div><div class='index'>58.</div><div class='index'>59.</div><div class='index'>60.</div><div class='index'>61.</div><div class='index'>62.</div><div class='index'>63.</div><div class='index'>64.</div><div class='index'>65.</div><div class='index'>66.</div><div class='index'>67.</div><div class='index'>68.</div><div class='index'>69.</div><div class='index'>70.</div><div class='index'>71.</div><div class='index'>72.</div><div class='index'>73.</div><div class='index'>74.</div><div class='index'>75.</div><div class='index'>76.</div><div class='index'>77.</div><div class='index'>78.</div><div class='index'>79.</div><div class='index'>80.</div><div class='index'>81.</div><div class='index'>82.</div><div class='index'>83.</div><div class='index'>84.</div><div class='index'>85.</div><div class='index'>86.</div><div class='index'>87.</div><div class='index'>88.</div><div class='index'>89.</div><div class='index'>90.</div><div class='index'>91.</div></div><div class="codePre"><code data-key='xmp'><span class="let">let </span>Vue;</code><code data-key='xmp'><span class="let">class </span>VueRouter<span class="log">{</span></code><code data-key='xmp'>  <span class="title"><span class="let">constructor</span><span class="log">(</span></span>options<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span>$options <span class="let">=</span> options;</code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">current</span> <span class="let">=</span> window<span class="log">.</span><span class="title1">location</span><span class="log">.</span><span class="title1">hash</span><span class="log">.</span><span class="title1">slice</span><span class="log">(</span>1<span class="log">)</span><span class="let"> || </span>'/';</code><code data-key='xmp'>    Vue<span class="log">.</span><span class="title1">util</span><span class="log">.</span><span class="title1">defineReactive</span><span class="log">(</span>this,<span class="string">"matched"</span>,[]<span class="log">)</span>;<span class="green">//Vue提供的,创建一个响应式的值,如果这个值改变,那么受它影响的render函数也会重新执行</span></code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">match</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>    window<span class="log">.</span><span class="title1">addEventListener</span><span class="log">(</span><span class="string">"hashchange"</span>,<span class="log">(</span><span class="log">)</span><span class="log"> => </span><span class="log">{</span></code><code data-key='xmp'>      <span class="green">//mode: hash主要就是通过hashchange事件去监听路由变化</span></code><code data-key='xmp'>      <span class="let">this</span><span class="log">.</span><span class="title1">current</span> <span class="let">=</span> window<span class="log">.</span><span class="title1">location</span><span class="log">.</span><span class="title1">hash</span><span class="log">.</span><span class="title1">slice</span><span class="log">(</span>1<span class="log">)</span>;<span class="green">//重新赋值当前hash值</span></code><code data-key='xmp'>       <span class="let">this</span><span class="log">.</span><span class="title1">matched</span> <span class="let">=</span> [];<span class="green">//每次匹配都要将之前匹配的路由信息删除掉</span></code><code data-key='xmp'>      <span class="let">this</span><span class="log">.</span><span class="title1">match</span><span class="log">(</span><span class="log">)</span>;<span class="green">//执行路由匹配</span></code><code data-key='xmp'>    <span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  <span class="title">match<span class="log">(</span></span>routes<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="green">//这里就是匹配层级</span></code><code data-key='xmp'>    routes <span class="let">=</span> routes<span class="let"> || </span><span class="let">this</span><span class="log">.</span>$options<span class="log">.</span><span class="title1">routes</span>;</code><code data-key='xmp'>    <span class="title"><span class="let">for</span><span class="log">(</span></span><span class="let">let </span>route <span class="let">of</span> routes<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="title"><span class="let">if</span><span class="log">(</span></span>route[<span class="string">"path"</span>] <span class="let">===</span> <span class="string">"/"</span> <span class="let">&</span><span class="let">&</span> <span class="let">this</span><span class="log">.</span><span class="title1">current</span> <span class="let">===</span> <span class="string">"/"</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>        <span class="green">//这里面就说明当前就是根路由,所以只有一层</span></code><code data-key='xmp'>        <span class="let">this</span><span class="log">.</span><span class="title1">matched</span><span class="log">.</span><span class="title1">push</span><span class="log">(</span>route<span class="log">)</span>;<span class="green">//就直接把当前的路由信息放在matched里面,到时候就可以通过depth拿到路由信息</span></code><code data-key='xmp'>        <span class="let">return</span>;</code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>      <span class="title"><span class="let">if</span><span class="log">(</span></span><span class="let">this</span><span class="log">.</span><span class="title1">current</span> <span class="let">!</span><span class="let">==</span> <span class="string">"/"</span> <span class="let">&</span><span class="let">&</span> <span class="let">this</span><span class="log">.</span><span class="title1">current</span><span class="log">.</span><span class="title1">indexOf</span><span class="log">(</span>route[<span class="string">"path"</span>]<span class="log">)</span> <span class="let">!</span><span class="let">==</span> <span class="let">-</span>1<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>        <span class="green">//如果当前的不是跟路由,而且当前路由path里面包含这个路由的path,说明就是相关的路由信息,装进matched里面</span></code><code data-key='xmp'>        <span class="let">this</span><span class="log">.</span><span class="title1">matched</span><span class="log">.</span><span class="title1">push</span><span class="log">(</span>route<span class="log">)</span>;</code><code data-key='xmp'>        <span class="title"><span class="let">if</span><span class="log">(</span></span>route[<span class="string">"children"</span>]<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>          <span class="green">//如果该route里面还有嵌套子路由，继续递归查找</span></code><code data-key='xmp'>          <span class="let">this</span><span class="log">.</span><span class="title1">match</span><span class="log">(</span>route[<span class="string">"children"</span>]<span class="log">)</span>;</code><code data-key='xmp'>        <span class="log">}</span></code><code data-key='xmp'>        <span class="let">return</span>;</code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'>VueRouter<span class="log">.</span><span class="title1">install</span> <span class="let">=</span> <span class="title"><span class='let'>function</span><span class="log">(</span></span>_Vue<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>  Vue <span class="let">=</span> _Vue;<span class="green">//将_Vue存起来,在VueRouter里面还会继续使用</span></code><code data-key='xmp'>  <span class="green">//利用全局的mixin,那么在每一个组件里面都会合并这个beforeCreate,</span></code><code data-key='xmp'>  <span class="green">//但是我这个方法只在有router这个属性的root身上才会执行</span></code><code data-key='xmp'>  <span class="green">//将实例对象直接挂载到Vue的原型身上,那么在所有的组件里面都可以使用$router了</span></code><code data-key='xmp'>  Vue<span class="log">.</span><span class="title1">mixin</span><span class="log">(</span><span class="log">{</span></code><code data-key='xmp'>    <span class="title">beforeCreate<span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="title"><span class="let">if</span><span class="log">(</span></span><span class="let">this</span><span class="log">.</span>$options <span class="let">&</span><span class="let">&</span> <span class="let">this</span><span class="log">.</span>$options<span class="log">.</span><span class="title1">router</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>        Vue<span class="log">.</span><span class="title1">prototype</span><span class="log">.</span>$router <span class="let">=</span> <span class="let">this</span><span class="log">.</span>$options<span class="log">.</span><span class="title1">router</span>;</code><code data-key='xmp'>     <span class="log">}</span></code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'>  <span class="green">//创建两个全局组件router<span class="let">-</span>link和router<span class="let">-</span>view</span></code><code data-key='xmp'>  Vue<span class="log">.</span><span class="title1">component</span><span class="log">(</span><span class="string">"router-link"</span>,<span class="log">{</span></code><code data-key='xmp'>    <span class="green">//router<span class="let">-</span>link其实渲染出来就是一个a标签</span></code><code data-key='xmp'>    <span class="green">//它并不发生跳转,是直接通过改变浏览器的hash,所以就是href里面的属性值是</span><span class="string">"#"</span> <span class="let">+</span> to里面的属性值</code><code data-key='xmp'>    <span class="green">//那to里面的属性值怎么拿呢,这个其实就是props父传子值,通过props接收就好了</span></code><code data-key='xmp'>    <span class="green">//最后一个问题,router<span class="let">-</span>link里面的内容应该就是a标签里面的内容,怎么拿?</span></code><code data-key='xmp'>   <span class="green">//这个也就是默认的插槽,可以直接通过$slots<span class="log">.</span><span class="title1">default</span>获取</span></code><code data-key='xmp'>    props: <span class="log">{</span></code><code data-key='xmp'>      to: <span class="log">{</span></code><code data-key='xmp'>        type: String,</code><code data-key='xmp'>        require: <span class="let">true</span></code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>    <span class="log">}</span>,</code><code data-key='xmp'>    <span class="title">render<span class="log">(</span></span>h<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="let">return</span> <span class="title">h<span class="log">(</span></span><span class="string">"a"</span>,<span class="log">{</span>attrs: <span class="log">{</span>href: <span class="string">"#"</span> <span class="let">+</span> <span class="let">this</span><span class="log">.</span><span class="title1">to</span><span class="log">}</span><span class="log">}</span>,<span class="let">this</span><span class="log">.</span>$slots<span class="log">.</span><span class="title1">default</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'>  <span class="green">//router<span class="let">-</span>view可能就麻烦点,它其实就是匹配routes里面的path,拿到符合条件的,渲染对象里面的component就好了</span></code><code data-key='xmp'>  <span class="green">//这块还有嵌套路由,那就要使用到递归来解决</span></code><code data-key='xmp'>  Vue<span class="log">.</span><span class="title1">component</span><span class="log">(</span><span class="string">"router-view"</span>,<span class="log">{</span></code><code data-key='xmp'>    <span class="title">render<span class="log">(</span></span>h<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'><span class="let">      let </span>component <span class="let">=</span> <span class='keyword'>null</span>;</code><code data-key='xmp'>      <span class="let">this</span><span class="log">.</span>$options<span class="log">.</span><span class="title1">routerView</span> <span class="let">=</span> <span class="let">true</span>;<span class="green">//标记这是一个routerView组件，那每个router<span class="let">-</span>view都有这个属性,那我就逐层向上查找有几个router<span class="let">-</span>view</span></code><code data-key='xmp'><span class="let">      let </span>depth <span class="let">=</span> 0;</code><code data-key='xmp'><span class="let">      let </span>parent <span class="let">=</span> <span class="let">this</span><span class="log">.</span>$parent;<span class="green">//拿到当前组件的父元素</span></code><code data-key='xmp'>      <span class="title"><span class="let">while</span><span class="log">(</span></span>parent<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>        <span class="green">//如果有parent会继续向上查找</span></code><code data-key='xmp'>        <span class="title"><span class="let">if</span><span class="log">(</span></span>parent<span class="log">.</span>$options <span class="let">&</span><span class="let">&</span> parent<span class="log">.</span>$options<span class="log">.</span><span class="title1">routerView</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>          <span class="green">//这就说明这个组件是一个router<span class="let">-</span>view，层级就得加一</span></code><code data-key='xmp'>          depth<span class="let">+</span><span class="let">+</span>;</code><code data-key='xmp'>        <span class="log">}</span></code><code data-key='xmp'>        parent <span class="let">=</span> parent<span class="log">.</span>$parent;<span class="green">//向上查找</span></code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>      <span class="title"><span class="let">if</span><span class="log">(</span></span><span class="let">this</span><span class="log">.</span>$router<span class="log">.</span><span class="title1">matched</span> <span class="let">&</span><span class="let">&</span> <span class="let">this</span><span class="log">.</span>$router<span class="log">.</span><span class="title1">matched</span>[depth]<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>        <span class="green">//拿到路由实例身上的matched判断是否有匹配上的路由信息</span></code><code data-key='xmp'>         <span class="title"><span class="let">if</span><span class="log">(</span></span><span class="let">this</span><span class="log">.</span>$router<span class="log">.</span><span class="title1">matched</span>[depth][<span class="string">"component"</span>]<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>           component <span class="let">=</span> <span class="let">this</span><span class="log">.</span>$router<span class="log">.</span><span class="title1">matched</span>[depth][<span class="string">"component"</span>];</code><code data-key='xmp'>        <span class="log">}</span></code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>      <span class="let">return</span> <span class="title">h<span class="log">(</span></span>component<span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'><span class="let">export default</span> VueRouter;</code></div></pre><div><div class='quote'>vue-router基本模型差不多就是这样了,history的模式就是换了种方式,使用history身上的两个方法pushState和replaceState,重写他们就好了</div></div><h3 id='Vuex' class='FD261354'>Vuex</h3><div><div class='quote'>Vuex是vue提供的一个全局状态管理，其实也就是vue提供的一个插件</div></div><span class="highlight">vuex使用</span><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div style='height: 14px;'></div><div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div><div class='index'>19.</div><div class='index'>20.</div><div class='index'>21.</div><div class='index'>22.</div><div class='index'>23.</div><div class='index'>24.</div><div class='index'>25.</div><div class='index'>26.</div><div class='index'>27.</div><div class='index'>28.</div><div class='index'>29.</div><div class='index'>30.</div><div class='index'>31.</div><div class='index'>32.</div><div class='index'>33.</div><div class='index'>34.</div><div class='index'>35.</div><div class='index'>36.</div><div class='index'>37.</div><div class='index'>38.</div><div class='index'>39.</div><div class='index'>40.</div><div class='index'>41.</div><div class='index'>42.</div></div><div class="codePre"><code data-key='xmp'><span class="let">import </span>Vuex<span class="let"> from </span><span class="string">"vuex"</span>;</code><code data-key='xmp'><span class="let">import </span>Vue<span class="let"> from </span><span class="string">"vue"</span>;</code><code data-key='xmp'> </code><code data-key='xmp'>Vue<span class="log">.</span><span class="title1">use</span><span class="log">(</span>Vuex<span class="log">)</span>;</code><code data-key='xmp'><span class="let">const </span>store <span class="let">=</span> Vuex<span class="log">.</span><span class="title1">Store</span><span class="log">(</span><span class="log">{</span></code><code data-key='xmp'>  state: <span class="log">{</span></code><code data-key='xmp'>    counter: 0</code><code data-key='xmp'>  <span class="log">}</span>,</code><code data-key='xmp'>  mutations: <span class="log">{</span></code><code data-key='xmp'>    <span class="title">add<span class="log">(</span></span>state,params<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      state<span class="log">.</span><span class="title1">counter</span><span class="let">+</span><span class="let">+</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span>,</code><code data-key='xmp'>  actions: <span class="log">{</span></code><code data-key='xmp'>    <span class="title">add<span class="log">(</span></span><span class="log">{</span>commit<span class="log">}</span>,params<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="title">setTimeout<span class="log">(</span></span><span class="log">(</span><span class="log">)</span><span class="log"> => </span><span class="log">{</span></code><code data-key='xmp'>        <span class="title">commit<span class="log">(</span></span><span class="string">"add"</span>,params<span class="log">)</span>;</code><code data-key='xmp'>      <span class="log">}</span>,1000<span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span>,</code><code data-key='xmp'>  modules: <span class="log">{</span><span class="log">}</span>,</code><code data-key='xmp'>  getters: <span class="log">{</span></code><code data-key='xmp'>    <span class="title">doubleCounter<span class="log">(</span></span>state<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="let">return</span> state<span class="log">.</span><span class="title1">counter</span> * 2;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'><span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'><span class="let">export </span>deafult store;</code><code data-key='xmp'><span class="green">//在main入口文件种引入</span></code><code data-key='xmp'><span class="let">import </span>store<span class="let"> from </span><span class="string">"./store/index.js"</span>;</code><code data-key='xmp'><span class="green">//挂载</span></code><code data-key='xmp'>Vue<span class="log">.</span><span class="title1">createApp</span><span class="log">(</span><span class="log">{</span></code><code data-key='xmp'>  store,</code><code data-key='xmp'>  template: `</code><code data-key='xmp'>    <span class='angleBracket'>&lt;</span><span class='elName'>div</span><span class='angleBracket'>&gt;</span></code><code data-key='xmp'>      <span class='angleBracket'>&lt;</span><span class='elName'>p</span><span class='angleBracket'>&gt;</span>counter<span class="log"> => </span><span class="log">{</span><span class="log">{</span>$store<span class="log">.</span><span class="title1">state</span><span class="log">.</span><span class="title1">counter</span><span class="log">}</span><span class="log">}</span><span class='angleBracket'>&lt;/</span><span class='elName'>p</span><span class='angleBracket'>&gt;</span></code><code data-key='xmp'>      <span class='angleBracket'>&lt;</span><span class='elName'>div</span><span class='attrKey'> @click</span><span class='angleBracket'>=</span><span class='attrValue'>"$store.commit('add')"</span><span class='angleBracket'>&gt;</span>立刻添加<span class='angleBracket'>&lt;/</span><span class='elName'>div</span><span class='angleBracket'>&gt;</span></code><code data-key='xmp'>      <span class='angleBracket'>&lt;</span><span class='elName'>div</span><span class='attrKey'> @click</span><span class='angleBracket'>=</span><span class='attrValue'>"$store.dispatch('add')"</span><span class='angleBracket'>&gt;</span>延迟一秒添加<span class='angleBracket'>&lt;/</span><span class='elName'>div</span><span class='angleBracket'>&gt;</span></code><code data-key='xmp'>      <span class='angleBracket'>&lt;</span><span class='elName'>div</span><span class='angleBracket'>&gt;</span>doubleCounter<span class="log"> => </span><span class="log">{</span><span class="log">{</span>$store<span class="log">.</span><span class="title1">getters</span><span class="log">.</span><span class="title1">doubleCounter</span><span class="log">}</span><span class="log">}</span><span class='angleBracket'>&lt;/</span><span class='elName'>div</span><span class='angleBracket'>&gt;</span></code><code data-key='xmp'>    <span class='angleBracket'>&lt;/</span><span class='elName'>div</span><span class='angleBracket'>&gt;</span></code><code data-key='xmp'>  `</code><code data-key='xmp'><span class="log">}</span><span class="log">)</span><span class="log">.</span><span class="title1">mount</span><span class="log">(</span><span class="string">"#app"</span><span class="log">)</span>;</code></div></pre><span class="highlight">vuex源码</span><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div><div class='index'>19.</div><div class='index'>20.</div><div class='index'>21.</div><div class='index'>22.</div><div class='index'>23.</div><div class='index'>24.</div><div class='index'>25.</div><div class='index'>26.</div></div><div class="codePre"><code data-key='xmp'><span class="let">let </span>Vue;</code><code data-key='xmp'><span class="let">class </span>Store<span class="log">{</span></code><code data-key='xmp'>  <span class="title"><span class="let">constructor</span><span class="log">(</span></span>options<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span>$options <span class="let">=</span> options;</code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span>$state <span class="let">=</span><span class="let"> new </span><span class="title">Vue<span class="log">(</span></span><span class="log">{</span></code><code data-key='xmp'>      data: options<span class="log">.</span><span class="title1">state</span><span class="let"> ? </span>optiions<span class="log">.</span><span class="title1">state</span><span class="let"> : </span><span class="log">{</span><span class="log">}</span></code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span>$actions <span class="let">=</span> options<span class="log">.</span><span class="title1">actions</span>;</code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span>$mutations <span class="let">=</span> options<span class="log">.</span><span class="title1">mutations</span>;</code><code data-key='xmp'>    <span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'>    </code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  <span class="title">commit<span class="log">(</span></span>name,payload<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    </code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'><span class='let'>function</span> <span class="title">install<span class="log">(</span></span>_Vue<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>  Vue <span class="let">=</span> _Vue;</code><code data-key='xmp'>  Vue<span class="log">.</span><span class="title1">minix</span><span class="log">(</span><span class="log">{</span></code><code data-key='xmp'>    <span class="title">beforeCreate<span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="title"><span class="let">if</span><span class="log">(</span></span><span class="let">this</span><span class="log">.</span>$options <span class="let">&</span><span class="let">&</span> <span class="let">this</span><span class="log">.</span>$options<span class="log">.</span><span class="title1">store</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>        Vue<span class="log">.</span><span class="title1">prototype</span><span class="log">.</span>$store <span class="let">=</span> <span class="let">this</span><span class="log">.</span>$options<span class="log">.</span><span class="title1">store</span>;</code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span><span class="log">)</span></code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'><span class="let">export default</span> <span class="log">{</span>Store,install<span class="log">}</span></code></div></pre><h3 id='Vue' class='FD429988'>Vue</h3><h4 id='diff算法' class='Xg651809'>diff算法</h4><p class="remind">废话不多说，直接看代码，有注解</p><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//传入两个参数,一个是新的vdom节点,一个是旧的vdom节点</span></code><code data-key='xmp'><span class='let'>function</span> <span class="title">patch<span class="log">(</span></span>newVnode,oldVnode<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>  <span class="green">//判断这两个节点是不是同一个</span></code><code data-key='xmp'>  <span class="title"><span class="let">if</span><span class="log">(</span></span>sameVnode<span class="log">(</span>newVnode,oldVnode<span class="log">)</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="green">//是同一个节点，那么就比较子节点</span></code><code data-key='xmp'>    <span class="title">patchVnode<span class="log">(</span></span>newVnode,oldVnode<span class="log">)</span>;</code><code data-key='xmp'>  <span class="log">}</span><span class="let">else</span><span class="log">{</span></code><code data-key='xmp'>    <span class="green">//这两个节点不是同一个节点</span></code><code data-key='xmp'>    <span class="green">//那应该干嘛,当然是删掉换新的上去啊,这里面没什么好说的了</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  <span class="let">return</span> newVnode;</code><code data-key='xmp'><span class="log">}</span></code></div></pre><p class="remind">sameVnode</p><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//主要就是判断新旧dom身上的key是否相等、它们的标签名是不是一样的</span></code><code data-key='xmp'><span class="green">//它们是不是都是注释</span></code><code data-key='xmp'><span class="green">//它们都含有data,这是组件</span></code><code data-key='xmp'><span class="green">//如果它们是input元素，那它们的type是不是一样的</span></code><code data-key='xmp'><span class="green">//如果都匹配,那么它们就是同一个元素</span></code><code data-key='xmp'><span class='let'>function</span> <span class="title">saveVnode<span class="log">(</span></span>newVnode,oldVnode<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>  <span class="let">return</span> newVnode<span class="log">.</span><span class="title1">key</span> <span class="let">===</span> oldVnode<span class="log">.</span><span class="title1">key</span> <span class="let">&</span><span class="let">&</span> </code><code data-key='xmp'>  newVnode<span class="log">.</span><span class="title1">tag</span> <span class="let">===</span> oldVnode<span class="log">.</span><span class="title1">tag</span> <span class="let">&</span><span class="let">&</span> </code><code data-key='xmp'>  newVnode<span class="log">.</span><span class="title1">isComment</span> <span class="let">===</span> oldVnode<span class="log">.</span><span class="title1">isComment</span> <span class="let">&</span><span class="let">&</span> </code><code data-key='xmp'>  <span class="title">isDef<span class="log">(</span></span>oldVnode<span class="log">.</span><span class="title1">data</span><span class="log">)</span> <span class="let">==</span> <span class="title">isDef<span class="log">(</span></span>oldVnode<span class="log">.</span><span class="title1">data</span><span class="log">)</span> <span class="let">&</span><span class="let">&</span> </code><code data-key='xmp'>  <span class="title">isInputType<span class="log">(</span></span>newVnode,oldVnode<span class="log">)</span>;</code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'><span class='let'>function</span> <span class="title">isDef<span class="log">(</span></span>val<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>  <span class="let">return</span> val <span class="let">!</span><span class="let">==</span> <span class='keyword'>undefined</span>;</code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'><span class='let'>function</span> <span class="title">isUndef<span class="log">(</span></span>val<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>  <span class="let">return</span> val <span class="let">===</span> <span class='keyword'>undefined</span>;</code><code data-key='xmp'><span class="log">}</span></code></div></pre><p class="remind">patchVnode</p><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div></div><div class="codePre"><code data-key='xmp'><span class='let'>function</span> <span class="title">patchVnode<span class="log">(</span></span>newVnode,oldVnode<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'><span class="let">  let </span>newCh <span class="let">=</span> newVnode<span class="log">.</span><span class="title1">chidlren</span>,oldCh <span class="let">=</span> oldValue<span class="log">.</span><span class="title1">children</span>;</code><code data-key='xmp'>  <span class="green">//两个新旧vdom都有孩子，并且它们的孩子不一样</span></code><code data-key='xmp'>  <span class="title"><span class="let">if</span><span class="log">(</span></span>newCh <span class="let">&</span><span class="let">&</span> oldCh <span class="let">&</span><span class="let">&</span> newCh <span class="let">!</span><span class="let">==</span> oldCh<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="title">updateChildren<span class="log">(</span></span>newCh,oldCh<span class="log">)</span>;<span class="green">//更新它们</span></code><code data-key='xmp'>  <span class="log">}</span><span class="let">else</span> <span class="title"><span class="let">if</span><span class="log">(</span></span>newCh<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>   <span class="green">//进入这了说明只有新的vdom有孩子,旧的vdom没有</span></code><code data-key='xmp'>   <span class="green">//那就遍历新的vdom,逐个创建插入到原来就的父元素身上</span></code><code data-key='xmp'>  <span class="log">}</span><span class="let">else</span> <span class="title"><span class="let">if</span><span class="log">(</span></span>oldCh<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>   <span class="green">//旧的有新的没有,全部删掉原来的子节点</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'><span class="log">}</span></code></div></pre><p class="remind">updateChildren</p><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div style='height: 14px;'></div><div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div><div class='index'>19.</div><div class='index'>20.</div><div class='index'>21.</div><div class='index'>22.</div><div class='index'>23.</div><div class='index'>24.</div><div class='index'>25.</div><div class='index'>26.</div><div class='index'>27.</div><div class='index'>28.</div><div class='index'>29.</div><div class='index'>30.</div><div class='index'>31.</div><div class='index'>32.</div><div class='index'>33.</div><div class='index'>34.</div><div class='index'>35.</div><div class='index'>36.</div><div class='index'>37.</div><div class='index'>38.</div><div class='index'>39.</div><div class='index'>40.</div><div class='index'>41.</div><div class='index'>42.</div><div class='index'>43.</div><div class='index'>44.</div><div class='index'>45.</div><div class='index'>46.</div><div class='index'>47.</div><div class='index'>48.</div><div class='index'>49.</div><div class='index'>50.</div><div class='index'>51.</div><div class='index'>52.</div><div class='index'>53.</div><div class='index'>54.</div><div class='index'>55.</div><div class='index'>56.</div><div class='index'>57.</div><div class='index'>58.</div><div class='index'>59.</div><div class='index'>60.</div><div class='index'>61.</div><div class='index'>62.</div><div class='index'>63.</div><div class='index'>64.</div><div class='index'>65.</div><div class='index'>66.</div><div class='index'>67.</div><div class='index'>68.</div><div class='index'>69.</div><div class='index'>70.</div><div class='index'>71.</div><div class='index'>72.</div><div class='index'>73.</div><div class='index'>74.</div><div class='index'>75.</div><div class='index'>76.</div><div class='index'>77.</div><div class='index'>78.</div><div class='index'>79.</div><div class='index'>80.</div><div class='index'>81.</div><div class='index'>82.</div><div class='index'>83.</div><div class='index'>84.</div><div class='index'>85.</div><div class='index'>86.</div><div class='index'>87.</div><div class='index'>88.</div><div class='index'>89.</div><div class='index'>90.</div><div class='index'>91.</div><div class='index'>92.</div><div class='index'>93.</div><div class='index'>94.</div><div class='index'>95.</div><div class='index'>96.</div><div class='index'>97.</div><div class='index'>98.</div><div class='index'>99.</div><div class='index'>100.</div><div class='index'>101.</div><div class='index'>102.</div><div class='index'>103.</div></div><div class="codePre"><code data-key='xmp'><span class='let'>function</span> <span class="title">updateChildren<span class="log">(</span></span>newCh,oldCh<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>  <span class="title"><span class="let">if</span><span class="log">(</span></span>newCh <span class="let">===</span> oldCh<span class="log">)</span><span class="let">return</span>;</code><code data-key='xmp'>  <span class="title"><span class="let">if</span><span class="log">(</span></span>isDef<span class="log">(</span>newCh<span class="log">.</span><span class="title1">text</span><span class="log">)</span> <span class="let">&</span><span class="let">&</span> <span class="title">isDef<span class="log">(</span></span>oldCh<span class="log">.</span><span class="title1">text</span><span class="log">)</span> <span class="let">&</span><span class="let">&</span> newCh<span class="log">.</span><span class="title1">text</span> <span class="let">!</span><span class="let">==</span> oldCh<span class="log">.</span><span class="title1">text</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>   <span class="green">//新旧vdom里面是文本,更新一下文本就好了</span></code><code data-key='xmp'>    <span class="let">return</span>;</code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'><span class="let">  let </span>newStartIdx <span class="let">=</span> 0,</code><code data-key='xmp'>  newStartVnode <span class="let">=</span> newCh[newStartIdx],</code><code data-key='xmp'>  newEndIdx <span class="let">=</span> newCh<span class="log">.</span><span class="title1">length</span> <span class="let">-</span> 1,</code><code data-key='xmp'>  newEndVnode <span class="let">=</span> newCh[newEndIdx],</code><code data-key='xmp'>  oldStartIdx <span class="let">=</span> 0,</code><code data-key='xmp'>  oldStartVnode <span class="let">=</span> oldCh[oldStartVnode],</code><code data-key='xmp'>  oldEndIdx <span class="let">=</span> oldCh<span class="log">.</span><span class="title1">length</span> <span class="let">-</span> 1,</code><code data-key='xmp'>  oldEndVnode <span class="let">=</span> oldCh[oldEndIdx],</code><code data-key='xmp'>  oldKeyToIdx;</code><code data-key='xmp'>  <span class="title"><span class="let">while</span><span class="log">(</span></span>newStartIdx<span class="let"> <= </span>endStartIdx <span class="let">&</span><span class="let">&</span> oldStartIdx<span class="let"> <= </span>oldEndIdx<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="title"><span class="let">if</span><span class="log">(</span></span>isUndef<span class="log">(</span>newStartVnode<span class="log">)</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      newStartVnode <span class="let">=</span> newCh[<span class="let">+</span><span class="let">+</span>newStratIdx];</code><code data-key='xmp'>    <span class="log">}</span><span class="let">else</span> <span class="title"><span class="let">if</span><span class="log">(</span></span>isUndef<span class="log">(</span>newEndVnode<span class="log">)</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      newEndVnode <span class="let">===</span> newCh[<span class="let">-</span><span class="let">-</span>newEndIdx];</code><code data-key='xmp'>    <span class="log">}</span><span class="let">else</span> <span class="title"><span class="let">if</span><span class="log">(</span></span>isUndef<span class="log">(</span>oldStartVnode<span class="log">)</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      oldStartVnode <span class="let">===</span> oldCh[<span class="let">+</span><span class="let">+</span>oldStartIdx];</code><code data-key='xmp'>    <span class="log">}</span><span class="let">else</span> <span class="title"><span class="let">if</span><span class="log">(</span></span>isUndef<span class="log">(</span>oldEndVnode<span class="log">)</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      oldEndVnode <span class="let">=</span> oldCh[<span class="let">-</span><span class="let">-</span>oldEndIdx];</code><code data-key='xmp'>    <span class="log">}</span><span class="let">else</span> <span class="title"><span class="let">if</span><span class="log">(</span></span>sameVnode<span class="log">(</span>newStartVnode,oldStartVnode<span class="log">)</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>     <span class="green">//新的vdom和旧的vdom相等</span></code><code data-key='xmp'>     <span class="green">//相同就不需要再移动元素位置了,元素位置并没有改变</span></code><code data-key='xmp'>     <span class="green">//递归比较子元素，比完之后再往下继续比较</span></code><code data-key='xmp'>      <span class="title">patchVnode<span class="log">(</span></span>newStartVnode,oldStartVnode<span class="log">)</span>;</code><code data-key='xmp'>      newStartVnode <span class="let">=</span> newCh[<span class="let">+</span><span class="let">+</span>newStartIdx];</code><code data-key='xmp'>      oldStartVnode <span class="let">=</span> oldCh[<span class="let">+</span><span class="let">+</span>oldStartIdx];</code><code data-key='xmp'>    <span class="log">}</span><span class="let">else</span> <span class="title"><span class="let">if</span><span class="log">(</span></span>sameVnode<span class="log">(</span>newStartVnode,oldEndVnode<span class="log">)</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>     <span class="green">//当新vdom的第一个节点和久的vdom的最后一个节点相同时</span></code><code data-key='xmp'>     <span class="green">//在久的vdom的最后一个子节点对应的真实dom位置移动到o</span></code><code data-key='xmp'>      <span class="title">patchVnode<span class="log">(</span></span>newStartVnode,oldEndVnode<span class="log">)</span>;</code><code data-key='xmp'>      <span class="green">//这里这个parentNode是oldStartVnode的父元素</span></code><code data-key='xmp'>      <span class="green">//代码并没有获取,只是表达这样的意思</span></code><code data-key='xmp'>      parentNode<span class="log">.</span><span class="title1">insertBefore</span><span class="log">(</span>oldStartVnode<span class="log">.</span><span class="title1">el</span>,oldEndVnode<span class="log">.</span><span class="title1">el</span><span class="log">)</span><span class="log">)</span>;</code><code data-key='xmp'>      newStartVnode <span class="let">=</span> newCH[<span class="let">+</span><span class="let">+</span>newStartIdx];</code><code data-key='xmp'>      oldEndVnode <span class="let">=</span> oldCh[<span class="let">-</span><span class="let">-</span>oldEndIdx];</code><code data-key='xmp'>    <span class="log">}</span><span class="let">else</span> <span class="title"><span class="let">if</span><span class="log">(</span></span>sameVnode<span class="log">(</span>newEndVnode,oldStartVnode<span class="log">)</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="green">//到这就说明新节点的newEndIdx下小和旧节点oldStartIdx对应的元素相同</span></code><code data-key='xmp'>      <span class="green">//那就说明oldStartIdx对应的元素被移动了或者中间插入了新的元素了</span></code><code data-key='xmp'>      <span class="green">//所以我们需要把oldStartVnode对应的真实dom移动到oldEndVnode对应的真实dom的后面</span></code><code data-key='xmp'>      <span class="title">patchVnode<span class="log">(</span></span>newEndVnode,oldStartVnode<span class="log">)</span>;</code><code data-key='xmp'>      <span class="green">//这里的parentNode和前面是一样的</span></code><code data-key='xmp'>      parentNode<span class="log">.</span><span class="title1">insertBefore</span><span class="log">(</span>oldstartVnode<span class="log">.</span><span class="title1">el</span>,oldEndVnode<span class="log">.</span><span class="title1">el</span><span class="log">.</span><span class="title1">nextSibling</span><span class="log">)</span><span class="log">)</span>;</code><code data-key='xmp'>      newEndVnode <span class="let">=</span> newCh[<span class="let">-</span><span class="let">-</span>newEndIdx];</code><code data-key='xmp'>      oldStartVnode <span class="let">=</span> oldCh[<span class="let">+</span><span class="let">+</span>oldStartIdx];</code><code data-key='xmp'>    <span class="log">}</span><span class="let">else</span> <span class="title"><span class="let">if</span><span class="log">(</span></span>sameVnode<span class="log">(</span>newEndVnode,oldEndVnode<span class="log">)</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="green">//这个其实就和start比较是一样的,位置一样不需要动</span></code><code data-key='xmp'>      <span class="title">patchVnode<span class="log">(</span></span>newEndVnode,oldEndVnode<span class="log">)</span>;</code><code data-key='xmp'>      newEndVnode <span class="let">=</span> newCh[<span class="let">-</span><span class="let">-</span>newEndIdx];</code><code data-key='xmp'>      oldEndVnode <span class="let">=</span> oldCh[<span class="let">-</span><span class="let">-</span>oldEndIdx];</code><code data-key='xmp'>    <span class="log">}</span><span class="let">else</span><span class="log">{</span></code><code data-key='xmp'>      <span class="title"><span class="let">if</span><span class="log">(</span></span>isUndef<span class="log">(</span>oldKeyToIdx<span class="log">)</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>        oldKeyToIdx <span class="let">=</span> <span class="title">createKeyToIdx<span class="log">(</span></span>oldCh,oldStartIdx,oldEndIdx<span class="log">)</span>;</code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>      idxInOld <span class="let">=</span> oldKeyToIdx[newStartVnode<span class="log">.</span><span class="title1">key</span>];</code><code data-key='xmp'>      <span class="title"><span class="let">if</span><span class="log">(</span></span>isUndef<span class="log">(</span>idxInOld<span class="log">)</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>        <span class="green">//说明旧的vdom节点中中没有相同key的元素</span></code><code data-key='xmp'>        <span class="green">//那我们就需要创建新节点插在oldStartVnode<span class="log">.</span><span class="title1">el</span>的前面</span></code><code data-key='xmp'>        parentNode<span class="log">.</span><span class="title1">insertBefore</span><span class="log">(</span>createEle<span class="log">(</span>newStartVnode<span class="log">)</span><span class="log">.</span><span class="title1">el</span>,oldStartVnode<span class="log">.</span><span class="title1">el</span><span class="log">)</span>;</code><code data-key='xmp'>      <span class="log">}</span><span class="let">else</span><span class="log">{</span></code><code data-key='xmp'>        <span class="green">//说明旧的vdom里面含有相同key的元素,但是不确定是不是同一个</span></code><code data-key='xmp'>        <span class="green">//拿出idxInOld位置的元素</span></code><code data-key='xmp'>        elToMove <span class="let">=</span> oldCh[idxInOld];</code><code data-key='xmp'>        <span class="title"><span class="let">if</span><span class="log">(</span></span><span class="let">!</span>sameVnode<span class="log">(</span>newStartVnode,elToMove<span class="log">)</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>          <span class="green">//相同key但不是同一个元素</span></code><code data-key='xmp'>          <span class="green">//创建新的元素插入到oldStartVnode元素的前面</span></code><code data-key='xmp'>          parentNode<span class="log">.</span><span class="title1">insertBefore</span><span class="log">(</span>createEle<span class="log">(</span>newStartVnode<span class="log">)</span><span class="log">.</span><span class="title1">el</span>,oldStartVnode<span class="log">)</span>;</code><code data-key='xmp'>        <span class="log">}</span><span class="let">else</span><span class="log">{</span></code><code data-key='xmp'>          <span class="green">//是同一个元素,递归子节点,再将elToMove移动到oldStartVnode<span class="log">.</span><span class="title1">el</span>的前面</span></code><code data-key='xmp'>          <span class="title">patchVnode<span class="log">(</span></span>newStartVnode,elToMove<span class="log">)</span>;</code><code data-key='xmp'>          oldCh[idxInOld] <span class="let">=</span> <span class='keyword'>undefined</span>;<span class="green">//清空，后续算法就不需要再去比较了</span></code><code data-key='xmp'>          parentNode<span class="log">.</span><span class="title1">insertBefore</span><span class="log">(</span>elToMove<span class="log">.</span><span class="title1">el</span>,oldStartVnode<span class="log">.</span><span class="title1">el</span><span class="log">)</span>;</code><code data-key='xmp'>        <span class="log">}</span></code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>      newStartVnode <span class="let">=</span> newCh[<span class="let">+</span><span class="let">+</span>newStartIdx];</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  <span class="green">//再这边遍历完了只会出现下面三种情况</span></code><code data-key='xmp'>  <span class="green">//第一： 可能只是newStartIdx<span class="let"> > </span>newEndIdx了导致循环结束,但是oldStartIdx<span class="let"> <= </span>oldEndIdx条件还是成立的</span></code><code data-key='xmp'>  <span class="green">//第二：可能只是oldStartIdx<span class="let"> > </span>oldEndIdx了，newStartIdx<span class="let"> <= </span>newEndIdx</span></code><code data-key='xmp'>  <span class="green">//第三：oldStartIdx<span class="let"> > </span>oldEndIdx和newStartIdx<span class="let"> > </span>newEndIdx同时成立</span></code><code data-key='xmp'>  <span class="green">//所以我们需要在这些条件成立的情况下，我们需要考虑是否还需要做其它的事情</span></code><code data-key='xmp'>  </code><code data-key='xmp'>  <span class="green">//老的vdom代表的是之前的真实dom的结构,新的vdom代表的是更新以后的vdom结构</span></code><code data-key='xmp'>  <span class="green">//目前视图上oldStartIdx到oldEndIdx位置显示还是根据旧的vdom结构显示的</span></code><code data-key='xmp'>  <span class="green">//那我们更新后是不是得让界面结构是和新的vdom结构相同</span></code><code data-key='xmp'>  <span class="green">//那现在新旧vdom比较后旧的vdom中多出来的是不是也是视图上多出的,所以我们是不是得删掉多余的</span></code><code data-key='xmp'>  <span class="green">//那新旧vdom比较新的vdom还有多余的,我是不是得加上去</span></code><code data-key='xmp'>  <span class="title"><span class="let">if</span><span class="log">(</span></span>newStartIdx<span class="let"> <= </span>newEndIdx<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="green">//这里是不是说还没添加完</span></code><code data-key='xmp'>    <span class="green">//我们需要把newStartIdx到newEndIdx位置的所有vdom元素转换成真实dom插入到后面去</span></code><code data-key='xmp'>    <span class="title">addVnodes<span class="log">(</span></span>parentNode,oldCh,oldStartIdx,oldEndIdx<span class="log">)</span>;</code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  <span class="title"><span class="let">if</span><span class="log">(</span></span>oldStartIdx<span class="let"> <= </span>oldEndIdx<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="green">//这里是不是说还剩许多多余的元素</span></code><code data-key='xmp'>    <span class="green">//我们需要把oldStartIdx到oldEndIdx位置处的所有vdom代表的真实dom给删掉</span></code><code data-key='xmp'>    <span class="title">removeNodes<span class="log">(</span></span>parentNode,newCh,newStartIdx,newEndIdx<span class="log">)</span>;</code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'><span class="log">}</span> </code></div></pre><p class="remind">createKeyToIdx</p><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div></div><div class="codePre"><code data-key='xmp'><span class='let'>function</span> <span class="title">createKeyToIdx<span class="log">(</span></span>children,startIdx,endIdx<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'><span class="let">  let </span>map <span class="let">=</span><span class="let"> new </span><span class="title">Map<span class="log">(</span></span><span class="log">)</span>,key;</code><code data-key='xmp'>  <span class="title"><span class="let">for</span><span class="log">(</span></span><span class="let">let </span>i <span class="let">=</span> startIdx;i<span class="let"> <= </span>endIdx;i<span class="let">+</span><span class="let">+</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    key <span class="let">=</span> children[i]<span class="log">.</span>key</code><code data-key='xmp'>    <span class="title"><span class="let">if</span><span class="log">(</span></span>key<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      map<span class="log">.</span><span class="title1">set</span><span class="log">(</span>key,i<span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  <span class="let">return</span> map;</code><code data-key='xmp'><span class="log">}</span></code></div></pre><h4 id='computed' class='Zg549394'>computed</h4><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div><div class='index'>19.</div><div class='index'>20.</div><div class='index'>21.</div><div class='index'>22.</div><div class='index'>23.</div><div class='index'>24.</div><div class='index'>25.</div><div class='index'>26.</div><div class='index'>27.</div><div class='index'>28.</div><div class='index'>29.</div><div class='index'>30.</div><div class='index'>31.</div><div class='index'>32.</div><div class='index'>33.</div><div class='index'>34.</div><div class='index'>35.</div><div class='index'>36.</div><div class='index'>37.</div><div class='index'>38.</div><div class='index'>39.</div><div class='index'>40.</div><div class='index'>41.</div><div class='index'>42.</div><div class='index'>43.</div><div class='index'>44.</div><div class='index'>45.</div><div class='index'>46.</div><div class='index'>47.</div><div class='index'>48.</div><div class='index'>49.</div><div class='index'>50.</div><div class='index'>51.</div><div class='index'>52.</div><div class='index'>53.</div><div class='index'>54.</div><div class='index'>55.</div><div class='index'>56.</div><div class='index'>57.</div><div class='index'>58.</div><div class='index'>59.</div><div class='index'>60.</div><div class='index'>61.</div><div class='index'>62.</div><div class='index'>63.</div><div class='index'>64.</div><div class='index'>65.</div><div class='index'>66.</div><div class='index'>67.</div><div class='index'>68.</div><div class='index'>69.</div><div class='index'>70.</div><div class='index'>71.</div><div class='index'>72.</div><div class='index'>73.</div><div class='index'>74.</div><div class='index'>75.</div><div class='index'>76.</div><div class='index'>77.</div><div class='index'>78.</div><div class='index'>79.</div><div class='index'>80.</div><div class='index'>81.</div><div class='index'>82.</div><div class='index'>83.</div><div class='index'>84.</div><div class='index'>85.</div><div class='index'>86.</div><div class='index'>87.</div><div class='index'>88.</div><div class='index'>89.</div><div class='index'>90.</div><div class='index'>91.</div><div class='index'>92.</div><div class='index'>93.</div><div class='index'>94.</div><div class='index'>95.</div><div class='index'>96.</div><div class='index'>97.</div><div class='index'>98.</div><div class='index'>99.</div><div class='index'>100.</div><div class='index'>101.</div><div class='index'>102.</div><div class='index'>103.</div><div class='index'>104.</div><div class='index'>105.</div><div class='index'>106.</div><div class='index'>107.</div><div class='index'>108.</div><div class='index'>109.</div><div class='index'>110.</div><div class='index'>111.</div><div class='index'>112.</div><div class='index'>113.</div><div class='index'>114.</div><div class='index'>115.</div><div class='index'>116.</div><div class='index'>117.</div><div class='index'>118.</div><div class='index'>119.</div><div class='index'>120.</div><div class='index'>121.</div><div class='index'>122.</div><div class='index'>123.</div><div class='index'>124.</div><div class='index'>125.</div><div class='index'>126.</div><div class='index'>127.</div><div class='index'>128.</div><div class='index'>129.</div><div class='index'>130.</div><div class='index'>131.</div><div class='index'>132.</div><div class='index'>133.</div><div class='index'>134.</div><div class='index'>135.</div><div class='index'>136.</div><div class='index'>137.</div><div class='index'>138.</div><div class='index'>139.</div><div class='index'>140.</div><div class='index'>141.</div><div class='index'>142.</div><div class='index'>143.</div><div class='index'>144.</div><div class='index'>145.</div><div class='index'>146.</div><div class='index'>147.</div><div class='index'>148.</div><div class='index'>149.</div><div class='index'>150.</div><div class='index'>151.</div><div class='index'>152.</div><div class='index'>153.</div><div class='index'>154.</div><div class='index'>155.</div><div class='index'>156.</div><div class='index'>157.</div><div class='index'>158.</div><div class='index'>159.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//首先从initData开始</span></code><code data-key='xmp'><span class='let'>function</span> <span class="title">initData<span class="log">(</span></span>vm<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>  <span class="green">//简写</span></code><code data-key='xmp'><span class="let">  const </span>data <span class="let">=</span> vm<span class="log">.</span>$options<span class="log">.</span><span class="title1">data</span>;</code><code data-key='xmp'>  <span class="green">//这里面还有data是对象的一些其它处理,反正处理完了data就是对象了</span></code><code data-key='xmp'>  vm<span class="log">.</span><span class="title1">_data</span> <span class="let">=</span> data;</code><code data-key='xmp'><span class="let">  const </span>keys <span class="let">=</span> Object<span class="log">.</span><span class="title1">keys</span><span class="log">(</span>data<span class="log">)</span>;</code><code data-key='xmp'><span class="let">  let </span>i <span class="let">=</span> keys<span class="log">.</span><span class="title1">length</span>;</code><code data-key='xmp'>  <span class="title"><span class="let">while</span><span class="log">(</span></span>i<span class="let">-</span><span class="let">-</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="title">proxy<span class="log">(</span></span>vm,<span class="string">"_data"</span>,keys[i]<span class="log">)</span>;</code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  <span class="title">observe<span class="log">(</span></span>data<span class="log">)</span>;<span class="green">//递归监听data中的property变化</span></code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'> </code><code data-key='xmp'><span class="let">const </span>noop <span class="let">=</span> <span class="log">(</span><span class="log">)</span><span class="log"> => </span><span class="log">{</span><span class="log">}</span></code><code data-key='xmp'><span class="let">const </span>sharedPropertyDefinition <span class="let">=</span> <span class="log">{</span></code><code data-key='xmp'>  enumerable: <span class="let">true</span>,</code><code data-key='xmp'>  configurable: <span class="let">true</span>,</code><code data-key='xmp'>  get: noop,</code><code data-key='xmp'>  set: noop</code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'><span class='let'>function</span> <span class="title">proxy<span class="log">(</span></span>target,sourceKey,key<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>  sharedPropertyDefinition<span class="log">.</span><span class="title1">get</span> <span class="let">=</span> <span class='let'>function</span> <span class="title">ProxyGetter<span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="let">return</span> target[sourceKey][key]</code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  sharedPropertyDefinition<span class="log">.</span><span class="title1">set</span> <span class="let">=</span> <span class='let'>function</span> <span class="title">ProxySetter<span class="log">(</span></span>val<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    target[sourceKey][key] <span class="let">=</span> val;</code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'> </code><code data-key='xmp'><span class='let'>function</span> <span class="title">observe<span class="log">(</span></span>value<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>  <span class="title"><span class="let">if</span><span class="log">(</span></span>value <span class="let">===</span> <span class='keyword'>null</span><span class="let"> || </span><span class="let">typeof</span> value <span class="let">!</span><span class="let">==</span> <span class="string">"object"</span><span class="log">)</span><span class="let">return</span>;</code><code data-key='xmp'>  <span class="let">return</span><span class="let"> new </span><span class="title">Observer<span class="log">(</span></span>value<span class="log">)</span>;</code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'><span class="let">class </span>Observer<span class="log">{</span></code><code data-key='xmp'>  <span class="title"><span class="let">constructor</span><span class="log">(</span></span>value<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">value</span> <span class="let">=</span> value;</code><code data-key='xmp'>    <span class="title"><span class="let">if</span><span class="log">(</span></span>Array<span class="log">.</span><span class="title1">isArray</span><span class="log">(</span>value<span class="log">)</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="green">//重写数组中的7个能改变数组的方法</span></code><code data-key='xmp'>      <span class="green">//递归遍历数组中的每一项</span></code><code data-key='xmp'>    <span class="log">}</span><span class="let">else</span><span class="log">{</span></code><code data-key='xmp'>      <span class="let">this</span><span class="log">.</span><span class="title1">walk</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  <span class="title">walk<span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'><span class="let">    const </span>keys <span class="let">=</span> Object<span class="log">.</span><span class="title1">keys</span><span class="log">(</span><span class="let">this</span><span class="log">.</span><span class="title1">value</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="title"><span class="let">for</span><span class="log">(</span></span><span class="let">let </span>i <span class="let">=</span> 0;i<span class="let"> < </span>keys,length;i<span class="let">+</span><span class="let">+</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="title">defineReactive<span class="log">(</span></span>this,value,keys[i]<span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'> </code><code data-key='xmp'><span class='let'>function</span> <span class="title">defineReactive<span class="log">(</span></span>obj,key,val<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'><span class="let">  let </span>dep <span class="let">=</span><span class="let"> new </span><span class="title">Dep<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>  val <span class="let">=</span> obj[key];</code><code data-key='xmp'>  <span class="title">observe<span class="log">(</span></span>val<span class="log">)</span>;</code><code data-key='xmp'>  Object<span class="log">.</span><span class="title1">defineProperty</span><span class="log">(</span>obj,key,<span class="log">{</span></code><code data-key='xmp'>    <span class="title">set<span class="log">(</span></span>nenVal<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="title">observe<span class="log">(</span></span>val<span class="log">)</span>;</code><code data-key='xmp'>      val <span class="let">=</span> newVal;</code><code data-key='xmp'>      dep<span class="log">.</span><span class="title1">notify</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span>,</code><code data-key='xmp'>    <span class="title">get<span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="title"><span class="let">if</span><span class="log">(</span></span>Dep<span class="log">.</span><span class="title1">target</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>        dep<span class="log">.</span><span class="title1">depend</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>      <span class="let">return</span> val;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span><span class="log">)</span></code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'> </code><code data-key='xmp'><span class="let">let </span>uid <span class="let">=</span> 0;</code><code data-key='xmp'><span class="let">class </span>Dep<span class="log">{</span></code><code data-key='xmp'>  static target;</code><code data-key='xmp'>  <span class="title"><span class="let">constructor</span><span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">subs</span> <span class="let">=</span> []; </code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">id</span> <span class="let">=</span> uid<span class="let">+</span><span class="let">+</span>;</code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  <span class="title">depend<span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="title"><span class="let">if</span><span class="log">(</span></span>Dep<span class="log">.</span><span class="title1">target</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      Dep<span class="log">.</span><span class="title1">target</span><span class="log">.</span><span class="title1">addDep</span><span class="log">(</span>this<span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span>,</code><code data-key='xmp'>  <span class="title">addSub<span class="log">(</span></span>sub<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">subs</span><span class="log">.</span><span class="title1">push</span><span class="log">(</span>sub<span class="log">)</span>;</code><code data-key='xmp'>  <span class="log">}</span>,</code><code data-key='xmp'>  <span class="title">notify<span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'><span class="let">    let </span>subs <span class="let">=</span> <span class="let">this</span><span class="log">.</span><span class="title1">subs</span><span class="log">.</span><span class="title1">slice</span><span class="log">(</span><span class="log">)</span>;<span class="green">//浅克隆一遍装watcher实例对象的数组</span></code><code data-key='xmp'>    <span class="title"><span class="let">for</span><span class="log">(</span></span><span class="let">let </span>i <span class="let">=</span> 0;i<span class="let"> < </span>subs<span class="log">.</span><span class="title1">length</span>;i<span class="let">+</span><span class="let">+</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      subs[i]<span class="log">.</span>update<span class="log">(</span><span class="log">)</span>;<span class="green">//更新了,告诉相关依赖变量的地方,变量更新了</span></code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'> </code><code data-key='xmp'><span class="let">const </span>targetStack <span class="let">=</span> []</code><code data-key='xmp'><span class='let'>function</span> <span class="title">pushTarget<span class="log">(</span></span>sub<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>  targetStack<span class="log">.</span><span class="title1">push</span><span class="log">(</span>sub<span class="log">)</span> ;</code><code data-key='xmp'>  Dep<span class="log">.</span><span class="title1">target</span> <span class="let">=</span> sub;</code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'> </code><code data-key='xmp'><span class='let'>function</span> <span class="title">popTarget<span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>  targetStack<span class="log">.</span><span class="title1">pop</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>  Dep<span class="log">.</span><span class="title1">target</span> <span class="let">=</span> targetStack[targetStack<span class="log">.</span><span class="title1">length</span> <span class="let">-</span> 1];</code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'> </code><code data-key='xmp'><span class="let">class </span>Watcher<span class="log">{</span></code><code data-key='xmp'>  <span class="title"><span class="let">constructor</span><span class="log">(</span></span>vm,expOrFn,cb,options<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">vm</span> <span class="let">=</span> vm;</code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">lazy</span> <span class="let">=</span> <span class="let">!</span><span class="let">!</span><span class="log">(</span>options <span class="let">&</span><span class="let">&</span> options<span class="log">.</span><span class="title1">lazy</span><span class="log">)</span>;<span class="green">//类型转换</span></code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">dirty</span> <span class="let">=</span> <span class="let">this</span><span class="log">.</span><span class="title1">lazy</span>;</code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">deps</span> <span class="let">=</span> [];</code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">newDeps</span> <span class="let">=</span> [];</code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">newDepIds</span> <span class="let">=</span><span class="let"> new </span><span class="title">Set<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">depIds</span> <span class="let">=</span><span class="let"> new </span><span class="title">Set<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">getter</span> <span class="let">=</span> expOrFn;<span class="green">//computed就会直接等于,watch可能不一样  </span></code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">value</span> <span class="let">=</span> <span class="let">this</span><span class="log">.</span><span class="title1">lazy</span><span class="let"> ? </span><span class='keyword'>undefined</span><span class="let"> : </span><span class="let">this</span><span class="log">.</span><span class="title1">get</span><span class="log">(</span><span class="log">)</span>;<span class="green">//computed初始化value是<span class='keyword'>undefined</span></span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  <span class="title">get<span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="title">pushTarget<span class="log">(</span></span>this<span class="log">)</span>;</code><code data-key='xmp'><span class="let">    let </span>value <span class="let">=</span> <span class="let">this</span><span class="log">.</span><span class="title1">getter</span><span class="log">.</span><span class="title1">call</span><span class="log">(</span><span class="let">this</span><span class="log">.</span><span class="title1">vm</span>,<span class="let">this</span><span class="log">.</span><span class="title1">vm</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="title">popTarget<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">cleanupDeps</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="let">return</span> value;</code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  <span class="title">addDeps<span class="log">(</span></span>dep<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'><span class="let">    const </span>id <span class="let">=</span> dep<span class="log">.</span><span class="title1">id</span></code><code data-key='xmp'>    <span class="title"><span class="let">if</span><span class="log">(</span></span><span class="let">!</span><span class="let">this</span><span class="log">.</span><span class="title1">newDepIds</span><span class="log">.</span><span class="title1">has</span><span class="log">(</span>id<span class="log">)</span><span class="log">)</span><span class="log">{</span><span class="green">//收集未收集的,已经收集的就不用收集了</span></code><code data-key='xmp'>      <span class="let">this</span><span class="log">.</span><span class="title1">newDepIds</span><span class="log">.</span><span class="title1">add</span><span class="log">(</span>id<span class="log">)</span>;</code><code data-key='xmp'>      <span class="let">this</span><span class="log">.</span><span class="title1">newDeps</span><span class="log">.</span><span class="title1">push</span><span class="log">(</span>dep<span class="log">)</span>;</code><code data-key='xmp'>      <span class="title"><span class="let">if</span><span class="log">(</span></span><span class="let">!</span><span class="let">this</span><span class="log">.</span><span class="title1">depIds</span><span class="log">.</span><span class="title1">has</span><span class="log">(</span>id<span class="log">)</span><span class="log">)</span><span class="log">{</span><span class="green">//这是上一次的依赖收集的list,就是上一次那边已经添加过我一次了,就没必要这次还加一次</span></code><code data-key='xmp'>        dep<span class="log">.</span><span class="title1">addSub</span><span class="log">(</span>this<span class="log">)</span>;</code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  <span class="title">cleanupDeps<span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'><span class="let">    let </span>i <span class="let">=</span> <span class="let">this</span><span class="log">.</span><span class="title1">deps</span><span class="log">.</span><span class="title1">length</span>;</code><code data-key='xmp'>    <span class="title"><span class="let">while</span><span class="log">(</span></span>i<span class="let">-</span><span class="let">-</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'><span class="let">      const </span>dep <span class="let">=</span> <span class="let">this</span><span class="log">.</span><span class="title1">deps</span>[i];</code><code data-key='xmp'>      <span class="title"><span class="let">if</span><span class="log">(</span></span><span class="let">!</span><span class="let">this</span><span class="log">.</span><span class="title1">newDepIds</span><span class="log">.</span><span class="title1">has</span><span class="log">(</span>dep<span class="log">.</span><span class="title1">id</span><span class="log">)</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>        <span class="green">//说明当前已经没有依赖变量了,就让它把自己删掉,下一次改变的时候就不用再通知我了</span></code><code data-key='xmp'>        dep<span class="log">.</span><span class="title1">removeSub</span><span class="log">(</span>this<span class="log">)</span>;</code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>    <span class="green">//更新</span></code><code data-key='xmp'>    [<span class="let">this</span><span class="log">.</span><span class="title1">depIds</span>,<span class="let">this</span><span class="log">.</span><span class="title1">newDepIds</span>] <span class="let">=</span> [<span class="let">this</span><span class="log">.</span><span class="title1">newDepIds</span>,<span class="let">this</span><span class="log">.</span><span class="title1">depIds</span>];</code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">newDepIds</span><span class="log">.</span><span class="title1">clear</span><span class="log">(</span><span class="log">)</span>;<span class="green">//清空,以便下一次继续依赖收集</span></code><code data-key='xmp'>    [<span class="let">this</span><span class="log">.</span><span class="title1">deps</span>,<span class="let">this</span><span class="log">.</span><span class="title1">newDep</span>] <span class="let">=</span> [<span class="let">this</span><span class="log">.</span><span class="title1">newDeps</span>,<span class="let">this</span><span class="log">.</span><span class="title1">deps</span>];</code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">newDeps</span><span class="log">.</span><span class="title1">length</span> <span class="let">=</span> 0;<span class="green">//清空</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  <span class="title">update<span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="title"><span class="let">if</span><span class="log">(</span></span><span class="let">this</span><span class="log">.</span><span class="title1">lazy</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="let">this</span><span class="log">.</span><span class="title1">dirty</span> <span class="let">=</span> <span class="let">true</span>;<span class="green">//computed是走的这里，这个属性在获取value的时候如果是true就知道依赖改变了,需要重新执行,否则就拿之前的结果,这就是缓存</span></code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'>  <span class="title">evaluate<span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">value</span> <span class="let">=</span> <span class="let">this</span><span class="log">.</span><span class="title1">get</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="let">this</span><span class="log">.</span><span class="title1">dirty</span> <span class="let">=</span> <span class="let">false</span>;<span class="green">//改回去,用作后续缓存判断</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'><span class="log">}</span></code></div></pre><p class="remind">computed源码</p><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div><div class='index'>19.</div><div class='index'>20.</div><div class='index'>21.</div><div class='index'>22.</div><div class='index'>23.</div><div class='index'>24.</div><div class='index'>25.</div><div class='index'>26.</div><div class='index'>27.</div><div class='index'>28.</div><div class='index'>29.</div><div class='index'>30.</div><div class='index'>31.</div><div class='index'>32.</div><div class='index'>33.</div><div class='index'>34.</div><div class='index'>35.</div></div><div class="codePre"><code data-key='xmp'><span class="let">const </span>computedWatcherOptions <span class="let">=</span> <span class="log">{</span> lazy: <span class="let">true</span> <span class="log">}</span></code><code data-key='xmp'><span class="let">const </span>noop <span class="let">=</span> <span class="log">(</span><span class="log">)</span><span class="log"> => </span><span class="log">{</span><span class="log">}</span>;</code><code data-key='xmp'><span class='let'>function</span> <span class="title">initComputed<span class="log">(</span></span>vm,computed<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'><span class="let">  const </span>watchers <span class="let">=</span> vm<span class="log">.</span><span class="title1">_computedWatchers</span> <span class="let">=</span> Object<span class="log">.</span><span class="title1">create</span><span class="log">(</span><span class='keyword'>null</span><span class="log">)</span></code><code data-key='xmp'>  <span class="title"><span class="let">for</span><span class="log">(</span></span><span class="let">let </span>key <span class="let">in</span> computed<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'><span class="let">    const </span>userDef <span class="let">=</span> computed[key];</code><code data-key='xmp'><span class="let">    const </span>getter <span class="let">=</span> userDef<span class="log">.</span><span class="title1">get</span><span class="let"> || </span>userDef;</code><code data-key='xmp'>    watchers[key] <span class="let">=</span><span class="let"> new </span><span class="title">Watcher<span class="log">(</span></span>vm,</code><code data-key='xmp'>      getter<span class="let"> || </span>noop,</code><code data-key='xmp'>      noop,</code><code data-key='xmp'>      computedWatcherOptions</code><code data-key='xmp'>    <span class="log">)</span>;</code><code data-key='xmp'>    <span class="title">defineComputed<span class="log">(</span></span>vm, key, userDef<span class="log">)</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'> </code><code data-key='xmp'><span class='let'>function</span> <span class="title">defineComputed<span class="log">(</span></span>target,key,userDef<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>  sharedPropertyDefinition<span class="log">.</span><span class="title1">get</span> <span class="let">=</span> <span class="title">createComputedGetter<span class="log">(</span></span>key<span class="log">)</span>;<span class="green">//走缓存的代码,不缓存的不看，不缓存就直接每次就执行getter方法拿到返回值就行了</span></code><code data-key='xmp'>  sharedPropertyDefinition<span class="log">.</span><span class="title1">set</span> <span class="let">=</span> userDef<span class="log">.</span><span class="title1">set</span><span class="let"> || </span>noop</code><code data-key='xmp'>  Object<span class="log">.</span><span class="title1">defineProperty</span><span class="log">(</span>target, key, sharedPropertyDefinition<span class="log">)</span></code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'><span class='let'>function</span> <span class="title">createComputedGetter<span class="log">(</span></span>key<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>  <span class="let">return</span> <span class='let'>function</span> <span class="title">computedGetter<span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>    <span class="green">//进到这里面就说明在vue中调用了computed中某个属性</span></code><code data-key='xmp'><span class="let">    const </span>watcher <span class="let">=</span> <span class="let">this</span><span class="log">.</span><span class="title1">_computedWatchers</span> <span class="let">&</span><span class="let">&</span> <span class="let">this</span><span class="log">.</span><span class="title1">_computedWatchers</span>[key];<span class="green">//这其实就是在initComputed中的watchers,里面都是每一项Watcher实例</span></code><code data-key='xmp'>    <span class="green">//然后这边还有一个this指向的问题,因为computedGetter这个方法是Object<span class="log">.</span><span class="title1">defineProperty</span>的get方法,那this就应该指向的是target,那target就是vm,vm又是vue实例,so<span class="log">.</span><span class="log">.</span><span class="log">.</span></span></code><code data-key='xmp'>    <span class="title"><span class="let">if</span><span class="log">(</span></span>watcher<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="title"><span class="let">if</span><span class="log">(</span></span>watcher<span class="log">.</span><span class="title1">dirty</span><span class="log">)</span><span class="log">{</span><span class="green">//判断该属性的依赖是否有更新的</span></code><code data-key='xmp'>        <span class="green">//依赖改变了就重新计算</span></code><code data-key='xmp'>        watcher<span class="log">.</span><span class="title1">evaluate</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>      <span class="let">return</span> watcher<span class="log">.</span><span class="title1">value</span>;<span class="green">//返回computed中的属性值</span></code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'><span class="log">}</span></code></div></pre><p class="remind">解析</p><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div><div class='index'>19.</div><div class='index'>20.</div><div class='index'>21.</div><div class='index'>22.</div><div class='index'>23.</div><div class='index'>24.</div><div class='index'>25.</div><div class='index'>26.</div><div class='index'>27.</div><div class='index'>28.</div><div class='index'>29.</div><div class='index'>30.</div><div class='index'>31.</div><div class='index'>32.</div><div class='index'>33.</div><div class='index'>34.</div><div class='index'>35.</div><div class='index'>36.</div><div class='index'>37.</div><div class='index'>38.</div><div class='index'>39.</div><div class='index'>40.</div><div class='index'>41.</div><div class='index'>42.</div><div class='index'>43.</div><div class='index'>44.</div><div class='index'>45.</div><div class='index'>46.</div><div class='index'>47.</div><div class='index'>48.</div><div class='index'>49.</div><div class='index'>50.</div><div class='index'>51.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//首先照常使用vue中的computed</span></code><code data-key='xmp'><span class="let">let </span>vm <span class="let">=</span><span class="let"> new </span><span class="title">Vue<span class="log">(</span></span><span class="log">{</span></code><code data-key='xmp'>  el: <span class="string">"#app"</span>,</code><code data-key='xmp'>  data: <span class="log">{</span></code><code data-key='xmp'>    count: 1</code><code data-key='xmp'>  <span class="log">}</span>,</code><code data-key='xmp'>  computed: <span class="log">{</span></code><code data-key='xmp'>    <span class="title">doubleCount<span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>      <span class="let">return</span> count <span class="let">+</span> 1;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>  <span class="log">}</span></code><code data-key='xmp'><span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'> </code><code data-key='xmp'> </code><code data-key='xmp'><span class="green">//initData流程</span></code><code data-key='xmp'><span class="green">//这样的代码内部会initData递归监听data中的所有的属性的变化，那count就是被监听的，并且给了它一个管家Dep实例</span></code><code data-key='xmp'><span class="green">//当设置它的时候,那它的管家就会告诉所有依赖count属性的更新函数我老大改了,你们也得改啊</span></code><code data-key='xmp'><span class="green">//当获取count的时候,管家又会看一下你是不是要依赖我老大,你要依赖,那我就把你电话记下来,下次我老大变了我通知你</span></code><code data-key='xmp'> </code><code data-key='xmp'><span class="green">//initComputed流程</span></code><code data-key='xmp'><span class="green">//首先遍历options中computed身上的所有的属性,判断属性值是方法还是对象，最终拿到getter方法，把它给到更新的地方去，并且将更新实例储存起来，为了后面能获取到</span></code><code data-key='xmp'><span class="green">//后面就是监听computed身上的每一个属性,主要就是调用的部分</span></code><code data-key='xmp'>console<span class="log">.</span><span class="title1">log</span><span class="log">(</span>vm<span class="log">.</span><span class="title1">doubleCount</span><span class="log">)</span>;</code><code data-key='xmp'><span class="green">//这样就会触发doubleCount身上的computedGetter监听方法，拿到之前存起来的更新实例</span></code><code data-key='xmp'><span class="green">//首次没有改变任何依赖调用computed中的属性</span></code><code data-key='xmp'><span class="green">//dirty属性值是true，它会调用更新实例上面的evaluate方法计算一遍，它会收集它的依赖，将dirty改为false</span></code><code data-key='xmp'><span class="green">//那第二次访问且没改变任何依赖那会直接返回value,不会再执行evaluate,这就是缓存的过程</span></code><code data-key='xmp'> </code><code data-key='xmp'><span class="green">//关于收集依赖</span></code><code data-key='xmp'><span class="green">//执行watcher上的evaluate方法会调用get方法</span></code><code data-key='xmp'><span class="green">//get方法中使用pushTarget将watcher更新实例放到了Dep构造函数的静态属性target身上</span></code><code data-key='xmp'><span class="green">//然后调用<span class="let">this</span><span class="log">.</span><span class="title1">getter</span>,关键就是在这了,getter是initComputed方法实例时候传过去的</span></code><code data-key='xmp'><span class="green">//那它执行getter方法是不是就是执行我们上面例子中的doubleComputed方法，那是不是就会调用我们的count,调用count会触发count身上的get监听方法</span></code><code data-key='xmp'><span class="green">//这时注意get里面是不是判断了Dep上面有没有target,或者说有没有值</span></code><code data-key='xmp'><span class="green">//我们上面不是设置了吗,那就会count的管家就会发现,欸,你依赖老大了,我得给你装起来</span></code><code data-key='xmp'><span class="green">//会调用管家身上的depend方法，这个depend方法又让更新函数那边判断一遍你之前有没有收集过我,你搜集过了,那就不需要再存一遍了</span></code><code data-key='xmp'><span class="green">//会调用更新实例上面的addDep方法收集管家,这个收集其实就是后面不依赖了得让管家给自己删了，不能说和你没关系了,你出什么事了你还找我吧，以及在这边判断自己这边有没有管家，有了就不用再次添加了</span></code><code data-key='xmp'><span class="green">//在addDeps中拿到管家独一无二的id，判断我这次依赖有没有收集过这个管家,因为可能在一个computed属性里面使用两次依赖,就比如说我拿data身上的数组属性的最后一项,如果这次没收集,那我就把它的id装进去以及管家实例对象装进去</span></code><code data-key='xmp'><span class="green">//那管家那边怎么收集更新呢</span></code><code data-key='xmp'><span class="green">//就得判断之前有没有存过</span></code><code data-key='xmp'><span class="green">//每次依赖收集完后watcher里面就会对比之前的搜集的管家,如果之前的是多出来的管家,那是不是表示现在不用了,以前用过,得给它删掉，不然后面会call你,那会受不了的,搞完了，这时就会将新搜集的管家作为上一次搜集的管家,新搜集的管家id作为上一次收集的管家id,把新的全部清空，以便下一次依赖收集,每次依赖改变都要从新收集</span></code><code data-key='xmp'><span class="green">//那其实只要判断上一次更新实例中的id列表有没有这个管家的id,如果有那管家那边是一定有我的电话的,那它那边就不用再存一遍了,如果没有那就说明要不就是删了要不就是存过,那就让管家那边再从新收集一遍，以便依赖改变的时候让管家通知更新</span></code><code data-key='xmp'><span class="green">//管家就将更新实例装进list里面</span></code><code data-key='xmp'> </code><code data-key='xmp'><span class="green">//那就可以看依赖改变流程怎么进行了</span></code><code data-key='xmp'><span class="green">//首先执行vm<span class="log">.</span><span class="title1">count</span> <span class="let">=</span> 2;就会触发count的set更新方法,这边会判断是否和上一次值一样再做操作，假设不一样，它会递归监听一下新值内的,如果新值是一个对象或者数组</span></code><code data-key='xmp'><span class="green">//然后储存新值</span></code><code data-key='xmp'><span class="green">//管家调更新方法</span></code><code data-key='xmp'><span class="green">//就跟小时候办喜事一样,大人拿出厚厚的电话簿找亲戚打电话,通知一下,那管家就直接调了computed更新实例上的更新方法把dirty变成true</span></code><code data-key='xmp'><span class="green">//这样又绕回来了,那再获取computed中的doubleCount属性时候dirty是true,知道依赖变了,重新执行get方法获得新值,并且重新收集依赖,可能依赖变了</span></code><code data-key='xmp'><span class="green">//然后就结束了</span></code></div></pre><a href='https://github.com/lixianghui666/vue-source-series.git' title='完整代码' target="_black">完整代码</a><div style='height: 14px;'></div>
                </div>
                <div class="rightDraw">
                <div class="menu"><div class="directory">目录</div><ul class="menuCon"><li class="menu_li"><a href="#Vue-Router源码" id="BE987642">Vue-Router源码</a></li><li class="menu_li"><a href="#Vuex" id="FD261354">Vuex</a></li><li class="menu_li"><a href="#Vue" id="FD429988">Vue</a><ul class="menuCon_1"><li class="menu_li0"><a href="#diff算法" id="Xg651809">diff算法</a></li><li class="menu_li1"><a href="#computed" id="Zg549394">computed</a></li></ul></li></ul></div>
                </div>
              </div>
           </div>
           <svg t="1648304059372" class="icon up" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3132" width="200" height="200"><path d="M832 64 192 64C121.6 64 64 121.6 64 192l0 640c0 70.4 57.6 128 128 128l640 0c70.4 0 128-57.6 128-128L960 192C960 121.6 902.4 64 832 64zM762.24 759.04c-12.8 12.8-33.28 12.8-45.44 0L513.92 560l-202.24 199.04c-12.8 12.8-33.28 12.8-45.44 0-12.8-12.8-12.8-32.64 0-45.44l224-220.16c6.4-6.4 15.36-9.6 24.32-8.96C522.88 483.84 531.2 487.04 538.24 493.44l224 220.16C775.04 726.4 775.04 746.24 762.24 759.04zM762.24 503.04c-12.8 12.8-33.28 12.8-45.44 0L513.92 304 311.68 503.04c-12.8 12.8-33.28 12.8-45.44 0-12.8-12.8-12.8-32.64 0-45.44l224-220.16c6.4-6.4 15.36-9.6 24.32-8.96C522.88 227.84 531.2 231.04 538.24 237.44l224 220.16C775.04 470.4 775.04 490.24 762.24 503.04z" p-id="3133" fill="#ffffff"></path></svg>
        </div>
        </body>
           <script>let titles = [{"title":"Vue-Router源码","id":"Vue-Router源码","index":3,"class":"BE987642"},{"title":"Vuex","id":"Vuex","index":3,"class":"FD261354"},{"title":"Vue","id":"Vue","index":3,"class":"FD429988","children":[{"title":"diff算法","id":"diff算法","index":4,"class":"Xg651809"},{"title":"computed","id":"computed","index":4,"class":"Zg549394"}]}];</script>
           <script src="../index.js" type="text/javascript"></script>
           </html>
            