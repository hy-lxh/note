
        <!DOCTYPE html>
         <html lang="en">
         <head>
	     <meta charset="UTF-8">
         <meta name="keywords" content="canvas笔记,博客,前端"/>
         <meta name="description" content="canvas一些api使用"/>
         <!--<meta http-equiv="content-security-policy" content="default-src self"/>-->
	     <title>canvas笔记</title>
        </head>
        <link rel="stylesheet" href="../main.css">
        <body>
        <div class="message_box"></div>
        <div class="content">
           <div id="view">
              <div>
                <div class="bs_content">
                   <h2 id='web前端绘图之canvas' class='bj224919'>web前端绘图之canvas</h2><h3 id='canvas标签' class='LB573134'>canvas标签</h3><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//canvas绘图那canvas标签是不能少的</span></code><code data-key='xmp'><span class="green">//canvas设置宽高一定要在行间设置，不要通过内联或者外联样式去设置，不然绘制出来的东西会变形</span></code><code data-key='xmp'><span class="green">//html部分只需要写一个canvas标签,大部分工作都是依靠js来完成的</span></code><code data-key='xmp'> </code><code data-key='xmp'><span class="green">//通过js获取到canvas，然后再去做别的其它的事情</span></code></div></pre><h4 id='html部分' class='Ki148014'>html部分</h4><img class="uploadImg" data-key="img" src="./imgs/upload_cf2446cb6c731158fee415e5fd8230d1.png"/><h4 id='js获取canvas画一个线' class='NF480274'>js获取canvas画一个线</h4><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div></div><div class="codePre"><code data-key='xmp'><span class="let">let </span>canvas <span class="let">=</span> document<span class="log">.</span><span class="title1">getElementById</span><span class="log">(</span><span class="string">"canvas1"</span><span class="log">)</span>,<span class="green">//获取canvas元素</span></code><code data-key='xmp'>    ctx <span class="let">=</span> canvas<span class="log">.</span><span class="title1">getContext</span><span class="log">(</span><span class="string">"2d"</span><span class="log">)</span>;<span class="green">//这是canvas自带的，返回canvas的执行上下文,绘图全靠它</span></code><code data-key='xmp'>    ctx<span class="log">.</span><span class="title1">beginPath</span><span class="log">(</span><span class="log">)</span>;<span class="green">//开启一个新路径，清除之前的路径</span></code><code data-key='xmp'>    ctx<span class="log">.</span><span class="title1">moveTo</span><span class="log">(</span>300, 200<span class="log">)</span>;<span class="green">//线开始的地方</span></code><code data-key='xmp'>    ctx<span class="log">.</span><span class="title1">lineTo</span><span class="log">(</span>500, 200<span class="log">)</span>;<span class="green">//线结束的地方</span></code><code data-key='xmp'>    ctx<span class="log">.</span><span class="title1">strokeStyle</span> <span class="let">=</span> <span class="string">"pink"</span>;<span class="green">//设置画笔颜色</span></code><code data-key='xmp'>    ctx<span class="log">.</span><span class="title1">lineWidth</span> <span class="let">=</span> <span class="string">"2"</span><span class="green">//设置画笔宽度</span></code><code data-key='xmp'>    ctx<span class="log">.</span><span class="title1">stroke</span><span class="log">(</span><span class="log">)</span>;<span class="green">//开始绘制方法</span></code><code data-key='xmp'>    ctx<span class="log">.</span><span class="title1">closePath</span><span class="log">(</span><span class="log">)</span>;<span class="green">//关闭这个路径</span></code><code data-key='xmp'>    <span class="green">//canvas左上角的那个角为原点</span></code></div></pre><h4 id='效果' class='hF999340'>效果</h4><img class="uploadImg" data-key="img" src="./imgs/upload_ad32c98474d2c4c437640fab9fb48ea7.png"/><h3 id='矩形' class='NG679826'>矩形</h3><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div style='height: 14px;'></div><div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//五种方法</span></code><code data-key='xmp'><span class="green">//第一种: 线性</span></code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">rect</span><span class="log">(</span>左上角的x,左上角的y,宽,高<span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">stroke</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'><span class="green">//第二种: 线性，和第一种一样</span></code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">strokeRect</span><span class="log">(</span>左上角的x,左上角的y,宽,高<span class="log">)</span>;</code><code data-key='xmp'><span class="green">//第三种: 填充型</span></code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">rect</span><span class="log">(</span>左上角的x,左上角的y,宽,高<span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">fill</span><span class="log">(</span><span class="log">)</span>;;</code><code data-key='xmp'><span class="green">//第四种</span></code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">fillRect</span><span class="log">(</span>左上角的x,左上角的y,宽,高<span class="log">)</span>;</code><code data-key='xmp'><span class="green">//第五种: 清除一块图形</span></code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">clearRect</span><span class="log">(</span>左上角的x,左上角的y,宽,高<span class="log">)</span></code></div></pre><h3 id='圆' class='DA715644'>圆</h3><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div></div><div class="codePre"><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">arc</span><span class="log">(</span>圆心x,圆心y,半径,弧起始,弧结束,是否逆向<span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">stroke</span><span class="log">(</span><span class="log">)</span>;<span class="green">//画线型的弧形</span></code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">fill</span><span class="log">(</span><span class="log">)</span>;<span class="green">//画带填充的弧形</span></code><code data-key='xmp'><span class="green">//画圆形给的度数都要转成弧度</span></code><code data-key='xmp'><span class="green">//度数转弧度: n * Math<span class="log">.</span><span class="title1">PI</span> / 180</span></code><code data-key='xmp'><span class="green">//弧度转度数: n * 180 / Math<span class="log">.</span><span class="title1">PI</span></span></code><code data-key='xmp'><span class="green">//逆向就是朝着原来相反的位置画，画出来的弧和不是逆向画的弧构成一个圆</span></code><code data-key='xmp'><span class="log">.</span><span class="log">.</span><span class="log">.</span></code></div></pre><h4 id='例子' class='ac347557'>例子</h4><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div style='height: 14px;'></div><div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div></div><div class="codePre"><code data-key='xmp'><span class="let">let </span>canvas <span class="let">=</span> document<span class="log">.</span><span class="title1">querySelector</span><span class="log">(</span><span class="string">"#canvas"</span><span class="log">)</span>;</code><code data-key='xmp'><span class="let">let </span>canvasW <span class="let">=</span> canvas<span class="log">.</span><span class="title1">width</span>,</code><code data-key='xmp'>    canvasH <span class="let">=</span> canvas<span class="log">.</span><span class="title1">height</span>;</code><code data-key='xmp'><span class="let">let </span>ctx <span class="let">=</span> canvas<span class="log">.</span><span class="title1">getContext</span><span class="log">(</span><span class="string">"2d"</span><span class="log">)</span>;</code><code data-key='xmp'><span class='let'>function</span> <span class="title">darcToArc<span class="log">(</span></span>n<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>   <span class="let">return</span> n * Math<span class="log">.</span><span class="title1">PI</span> / 180;</code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">beginPath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">arc</span><span class="log">(</span>canvasW / 2, canvasH / 2, 100, <span class="title">darcToArc<span class="log">(</span></span>0<span class="log">)</span>, <span class="title">darcToArc<span class="log">(</span></span>100<span class="log">)</span>, <span class="let">false</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">strokeStyle</span> <span class="let">=</span> <span class="string">"pink"</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">lineWidth</span> <span class="let">=</span> 5;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">stroke</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">closePath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">beginPath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">arc</span><span class="log">(</span>canvasW / 2, canvasH / 2, 100, <span class="title">darcToArc<span class="log">(</span></span>0<span class="log">)</span>, <span class="title">darcToArc<span class="log">(</span></span>100<span class="log">)</span>, <span class="let">true</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">strokeStyle</span> <span class="let">=</span> <span class="string">"green"</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">stroke</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">closePath</span><span class="log">(</span><span class="log">)</span>;</code></div></pre><h4 id='效果' class='fZ462748'>效果</h4><img class="uploadImg" data-key="img" src="./imgs/upload_16299ad1141a808a80987c407a4ae5fe.png"/><h4 id='画饼图案例' class='GF829428'>画饼图案例</h4><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div style='height: 14px;'></div><div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div><div class='index'>19.</div><div class='index'>20.</div><div class='index'>21.</div><div class='index'>22.</div><div class='index'>23.</div><div class='index'>24.</div><div class='index'>25.</div><div class='index'>26.</div></div><div class="codePre"><code data-key='xmp'><span class='let'>function</span> <span class="title">Darc<span class="log">(</span></span>startAng, endAng, color<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>  <span class="let">this</span><span class="log">.</span><span class="title1">endAng</span> <span class="let">=</span> endAng;</code><code data-key='xmp'>  <span class="let">this</span><span class="log">.</span><span class="title1">startAng</span> <span class="let">=</span> startAng;</code><code data-key='xmp'>  <span class="let">this</span><span class="log">.</span><span class="title1">color</span> <span class="let">=</span> color;</code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'><span class="let">let </span>img <span class="let">=</span> document<span class="log">.</span><span class="title1">getElementsByTagName</span><span class="log">(</span><span class="string">"img"</span><span class="log">)</span>[0];</code><code data-key='xmp'><span class="let">let </span>canvasW <span class="let">=</span> <span class="title">parseInt<span class="log">(</span></span>canvas<span class="log">.</span><span class="title1">width</span><span class="log">)</span>,</code><code data-key='xmp'>    canvasH <span class="let">=</span> <span class="title">parseInt<span class="log">(</span></span>canvas<span class="log">.</span><span class="title1">height</span><span class="log">)</span>;</code><code data-key='xmp'><span class="let">let </span>data <span class="let">=</span> [<span class="let">new </span><span class="title">Darc<span class="log">(</span></span>0, 50, <span class="string">"pink"</span><span class="log">)</span>,<span class="let"> new </span><span class="title">Darc<span class="log">(</span></span>50, 140, <span class="string">"green"</span><span class="log">)</span>,<span class="let"> new </span><span class="title">Darc<span class="log">(</span></span>140, 0, <span class="string">"yellow"</span><span class="log">)</span>];</code><code data-key='xmp'><span class="let">let </span>arcX <span class="let">=</span> canvasW / 2,</code><code data-key='xmp'>    arcY <span class="let">=</span> canvasH / 2,</code><code data-key='xmp'>    arcR <span class="let">=</span> 100;</code><code data-key='xmp'><span class='let'>function</span> <span class="title">drawPieChart<span class="log">(</span></span>arcX, arcY, arcR, color, endAng, startAng<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>  ctx<span class="log">.</span><span class="title1">beginPath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>  ctx<span class="log">.</span><span class="title1">moveTo</span><span class="log">(</span>arcX, arcY<span class="log">)</span>;</code><code data-key='xmp'>  ctx<span class="log">.</span><span class="title1">lineTo</span><span class="log">(</span>arcX <span class="let">+</span> arcR * Math<span class="log">.</span><span class="title1">cos</span><span class="log">(</span>d2a<span class="log">(</span>startAng<span class="log">)</span><span class="log">)</span>, arcY <span class="let">+</span> arcR * Math<span class="log">.</span><span class="title1">sin</span><span class="log">(</span>d2a<span class="log">(</span>startAng<span class="log">)</span><span class="log">)</span><span class="log">)</span>;</code><code data-key='xmp'>  ctx<span class="log">.</span><span class="title1">arc</span><span class="log">(</span>arcX, arcY, arcR, <span class="title">d2a<span class="log">(</span></span>startAng<span class="log">)</span>, <span class="title">d2a<span class="log">(</span></span>endAng<span class="log">)</span>, <span class="let">false</span><span class="log">)</span>;</code><code data-key='xmp'>  ctx<span class="log">.</span><span class="title1">moveTo</span><span class="log">(</span>arcX, arcY<span class="log">)</span>;</code><code data-key='xmp'>  ctx<span class="log">.</span><span class="title1">lineTo</span><span class="log">(</span>arcX <span class="let">+</span> arcR * Math<span class="log">.</span><span class="title1">cos</span><span class="log">(</span>d2a<span class="log">(</span>endAng<span class="log">)</span><span class="log">)</span>, arcY <span class="let">+</span> arcR * Math<span class="log">.</span><span class="title1">sin</span><span class="log">(</span>d2a<span class="log">(</span>endAng<span class="log">)</span><span class="log">)</span><span class="log">)</span>;</code><code data-key='xmp'>  ctx<span class="log">.</span><span class="title1">fillStyle</span> <span class="let">=</span> color;</code><code data-key='xmp'>  ctx<span class="log">.</span><span class="title1">fill</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>  ctx<span class="log">.</span><span class="title1">closePath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>for <span class="log">(</span><span class="let">let </span>darc <span class="let">of</span> data<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>  <span class="title">drawPieChart<span class="log">(</span></span>arcX, arcY, arcR, darc<span class="log">.</span><span class="title1">color</span>, darc<span class="log">.</span><span class="title1">endAng</span>, darc<span class="log">.</span><span class="title1">startAng</span><span class="log">)</span>;</code><code data-key='xmp'><span class="log">}</span></code></div></pre><h4 id='效果' class='DG397220'>效果</h4><img class="uploadImg" data-key="img" src="./imgs/upload_3e943996d27c944e689bb16ef9a1b51b.png"/><h3 id='transform' class='XA025064'>transform</h3><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div style='height: 14px;'></div><div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div><div class='index'>19.</div><div class='index'>20.</div><div class='index'>21.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//canvas里面的transform和css3里面的是一样的,只不过canvas里面的没有skew，还有本身操作的是canvas</span></code><code data-key='xmp'><span class="green">//所以很麻烦[苦笑]</span></code><code data-key='xmp'><span class="green">//如果轻易操作，会影响到后面继续绘制元素</span></code><code data-key='xmp'><span class="green">//例子</span></code><code data-key='xmp'><span class="let">let </span>canvas <span class="let">=</span> document<span class="log">.</span><span class="title1">querySelector</span><span class="log">(</span><span class="string">"#canvas"</span><span class="log">)</span>,</code><code data-key='xmp'>    ctx <span class="let">=</span> canvas<span class="log">.</span><span class="title1">getContext</span><span class="log">(</span><span class="string">"2d"</span><span class="log">)</span>,</code><code data-key='xmp'>    canvasW <span class="let">=</span> canvas<span class="log">.</span><span class="title1">width</span>,</code><code data-key='xmp'>    canvasH <span class="let">=</span> canvas<span class="log">.</span><span class="title1">height</span>;</code><code data-key='xmp'><span class='let'>function</span> <span class="title">darcToArc<span class="log">(</span></span>n<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>   <span class="let">return</span> n * Math<span class="log">.</span><span class="title1">PI</span> / 180;</code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">beginPath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">rotate</span><span class="log">(</span>darcToArc<span class="log">(</span>30<span class="log">)</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">fillStyle</span> <span class="let">=</span> <span class="string">"#fff"</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">fillRect</span><span class="log">(</span>0, 0, canvasW, canvasH<span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">closePath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">beginPath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">rect</span><span class="log">(</span><span class="log">(</span>canvasW <span class="let">-</span> 200<span class="log">)</span> / 2, <span class="log">(</span>canvasH <span class="let">-</span> 100<span class="log">)</span> / 2, 200, 100<span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">fillStyle</span> <span class="let">=</span> <span class="string">"pink"</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">fill</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">closePath</span><span class="log">(</span><span class="log">)</span>;</code></div></pre><img class="uploadImg" data-key="img" src="./imgs/upload_dc4406fcb3951ab5dc764535e8aba85f.png"/><div><div class='quote'>本来我只想把白色的矩形旋转30度,没想到粉红色的矩形也转了,而且还不是按照圆心转的，是按照canvas原点,当然东西做出来不可能是没有用的,有没有办法解决，答案是有，看后续</div></div><h4 id='物体不按照中心旋转解决' class='GF437467'>物体不按照中心旋转解决</h4><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//canvas使用rotate旋转物体不是按照图形中心进行旋转，而是按照canvas的原点进行旋转</span></code><code data-key='xmp'><span class="green">//而且canvas里面transform的属性的执行顺序是按照代码后面先执行再执行前面的</span></code><code data-key='xmp'><span class="green">//首先我们默认把图形的中心移动到原点，然后旋转后再将图形移动到<span class="log">(</span>图形宽度的一半 <span class="let">+</span> 本来要将图形画到的点x位置,图形高度的一半 <span class="let">+</span> 本来要将图形画到1点y位置<span class="log">)</span>;</span></code><code data-key='xmp'><span class="green">//然后物体就是围绕自己中心旋转</span></code><code data-key='xmp'><span class="green">//rotate 和 translate 和 scale执行都是累积的，比如第一次执行rotate<span class="log">(</span>30 * Math<span class="log">.</span><span class="title1">PI</span> / 180<span class="log">)</span>,第二次执行roate<span class="log">(</span>30 * Math<span class="log">.</span><span class="title1">PI</span> / 180<span class="log">)</span> 第二次就是旋转60弧度了</span></code><code data-key='xmp'><span class="green">//当然这也是有解决办法的，就是利用save和restore方法</span></code><code data-key='xmp'><span class="green">//save就是保存当前画布的，restore就是恢复上一次保存的画布</span></code></div></pre><h4 id='代码' class='Kg363682'>代码</h4><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div></div><div class="codePre"><code data-key='xmp'><span class="let">let </span>canvas <span class="let">=</span> document<span class="log">.</span><span class="title1">getElementById</span><span class="log">(</span><span class="string">"canvas"</span><span class="log">)</span>,</code><code data-key='xmp'>    canvasHeight <span class="let">=</span> canvas<span class="log">.</span><span class="title1">offsetHeight</span>,</code><code data-key='xmp'>    canvasWidth <span class="let">=</span> canvas<span class="log">.</span><span class="title1">offsetWidth</span>,</code><code data-key='xmp'>    ctx <span class="let">=</span> canvas<span class="log">.</span><span class="title1">getContext</span><span class="log">(</span><span class="string">"2d"</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">beginPath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">save</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">translate</span><span class="log">(</span><span class="log">(</span>canvasWidth <span class="let">-</span> 200<span class="log">)</span> / 2 <span class="let">+</span> 100, <span class="log">(</span>canvasHeight <span class="let">-</span> 100<span class="log">)</span> / 2 <span class="let">+</span> 50<span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">rotate</span><span class="log">(</span>45 * Math<span class="log">.</span><span class="title1">PI</span> / 180<span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">rect</span><span class="log">(</span><span class="let">-</span>100, <span class="let">-</span>50, 200, 100<span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">fillStyle</span> <span class="let">=</span> <span class="string">"pink"</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">fill</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">closePath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">restore</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">rect</span><span class="log">(</span><span class="log">(</span>canvasWidth <span class="let">-</span> 200<span class="log">)</span> / 2, <span class="log">(</span>canvasHeight <span class="let">-</span> 100<span class="log">)</span> / 2, 200, 100<span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">fillStyle</span> <span class="let">=</span> <span class="string">"pink"</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">fill</span><span class="log">(</span><span class="log">)</span>;</code></div></pre><h4 id='效果显示' class='Dh887037'>效果显示</h4><img class="uploadImg" data-key="img" src="./imgs/upload_e5f401b5ca7143ebf900e6b51719227f.PNG"/><h4 id='抽奖案例' class='Dg940671'>抽奖案例</h4><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div style='height: 14px;'></div><div style='height: 14px;'></div><div style='height: 14px;'></div><div style='height: 14px;'></div><div style='height: 14px;'></div><div style='height: 14px;'></div><div style='height: 14px;'></div><div style='height: 14px;'></div><div style='height: 14px;'></div><div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div><div class='index'>19.</div><div class='index'>20.</div><div class='index'>21.</div><div class='index'>22.</div><div class='index'>23.</div><div class='index'>24.</div><div class='index'>25.</div><div class='index'>26.</div><div class='index'>27.</div><div class='index'>28.</div><div class='index'>29.</div><div class='index'>30.</div><div class='index'>31.</div><div class='index'>32.</div><div class='index'>33.</div><div class='index'>34.</div><div class='index'>35.</div><div class='index'>36.</div><div class='index'>37.</div><div class='index'>38.</div><div class='index'>39.</div><div class='index'>40.</div><div class='index'>41.</div><div class='index'>42.</div><div class='index'>43.</div><div class='index'>44.</div><div class='index'>45.</div><div class='index'>46.</div><div class='index'>47.</div><div class='index'>48.</div><div class='index'>49.</div><div class='index'>50.</div><div class='index'>51.</div><div class='index'>52.</div><div class='index'>53.</div><div class='index'>54.</div><div class='index'>55.</div><div class='index'>56.</div><div class='index'>57.</div><div class='index'>58.</div><div class='index'>59.</div><div class='index'>60.</div><div class='index'>61.</div><div class='index'>62.</div><div class='index'>63.</div><div class='index'>64.</div><div class='index'>65.</div><div class='index'>66.</div><div class='index'>67.</div><div class='index'>68.</div><div class='index'>69.</div><div class='index'>70.</div><div class='index'>71.</div><div class='index'>72.</div><div class='index'>73.</div><div class='index'>74.</div><div class='index'>75.</div><div class='index'>76.</div><div class='index'>77.</div><div class='index'>78.</div><div class='index'>79.</div><div class='index'>80.</div><div class='index'>81.</div><div class='index'>82.</div><div class='index'>83.</div><div class='index'>84.</div><div class='index'>85.</div><div class='index'>86.</div><div class='index'>87.</div><div class='index'>88.</div><div class='index'>89.</div><div class='index'>90.</div><div class='index'>91.</div><div class='index'>92.</div><div class='index'>93.</div><div class='index'>94.</div><div class='index'>95.</div><div class='index'>96.</div><div class='index'>97.</div><div class='index'>98.</div><div class='index'>99.</div><div class='index'>100.</div><div class='index'>101.</div><div class='index'>102.</div><div class='index'>103.</div><div class='index'>104.</div><div class='index'>105.</div><div class='index'>106.</div><div class='index'>107.</div><div class='index'>108.</div><div class='index'>109.</div><div class='index'>110.</div><div class='index'>111.</div><div class='index'>112.</div><div class='index'>113.</div><div class='index'>114.</div><div class='index'>115.</div><div class='index'>116.</div><div class='index'>117.</div><div class='index'>118.</div><div class='index'>119.</div><div class='index'>120.</div><div class='index'>121.</div><div class='index'>122.</div><div class='index'>123.</div><div class='index'>124.</div><div class='index'>125.</div><div class='index'>126.</div><div class='index'>127.</div><div class='index'>128.</div><div class='index'>129.</div><div class='index'>130.</div><div class='index'>131.</div><div class='index'>132.</div><div class='index'>133.</div><div class='index'>134.</div><div class='index'>135.</div><div class='index'>136.</div><div class='index'>137.</div><div class='index'>138.</div><div class='index'>139.</div><div class='index'>140.</div><div class='index'>141.</div><div class='index'>142.</div><div class='index'>143.</div><div class='index'>144.</div><div class='index'>145.</div><div class='index'>146.</div><div class='index'>147.</div><div class='index'>148.</div><div class='index'>149.</div><div class='index'>150.</div><div class='index'>151.</div><div class='index'>152.</div><div class='index'>153.</div><div class='index'>154.</div><div class='index'>155.</div><div class='index'>156.</div><div class='index'>157.</div><div class='index'>158.</div><div class='index'>159.</div><div class='index'>160.</div><div class='index'>161.</div><div class='index'>162.</div><div class='index'>163.</div><div class='index'>164.</div><div class='index'>165.</div><div class='index'>166.</div><div class='index'>167.</div><div class='index'>168.</div><div class='index'>169.</div><div class='index'>170.</div><div class='index'>171.</div><div class='index'>172.</div><div class='index'>173.</div><div class='index'>174.</div><div class='index'>175.</div><div class='index'>176.</div><div class='index'>177.</div><div class='index'>178.</div></div><div class="codePre"><code data-key='xmp'><span class="let">let </span>canvas <span class="let">=</span> document<span class="log">.</span><span class="title1">getElementById</span><span class="log">(</span><span class="string">"canvas"</span><span class="log">)</span>;</code><code data-key='xmp'><span class="let">    let </span>canvasHeight <span class="let">=</span> canvas<span class="log">.</span><span class="title1">offsetHeight</span>,</code><code data-key='xmp'>        canvasWidth <span class="let">=</span> canvas<span class="log">.</span><span class="title1">offsetWidth</span>;</code><code data-key='xmp'><span class="let">    let </span>ctx <span class="let">=</span> canvas<span class="log">.</span><span class="title1">getContext</span><span class="log">(</span><span class="string">"2d"</span><span class="log">)</span>;</code><code data-key='xmp'><span class="let">    let </span>gameStatus <span class="let">=</span> <span class="string">"over"</span>;</code><code data-key='xmp'>    <span class='let'>function</span> <span class="title">drac<span class="log">(</span></span>num, type<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>        if <span class="log">(</span>type <span class="let">==</span> <span class="string">"degree"</span><span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>            <span class="let">return</span> num * 180 / Math<span class="log">.</span><span class="title1">PI</span>;</code><code data-key='xmp'>        <span class="log">}</span> else <span class="log">{</span></code><code data-key='xmp'>            <span class="let">return</span> num * Math<span class="log">.</span><span class="title1">PI</span> / 180;</code><code data-key='xmp'>        <span class="log">}</span></code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>    <span class='let'>function</span> <span class="title">drawPieChart<span class="log">(</span></span>x, y, r, fillColor, startAng, endAng, text, textColor <span class="let">=</span> <span class="string">"#FFFAFA"</span><span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">beginPath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">moveTo</span><span class="log">(</span>x, y<span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">lineTo</span><span class="log">(</span>x <span class="let">+</span> r * Math<span class="log">.</span><span class="title1">cos</span><span class="log">(</span>drac<span class="log">(</span>startAng<span class="log">)</span><span class="log">)</span>, y <span class="let">+</span> r * Math<span class="log">.</span><span class="title1">sin</span><span class="log">(</span>drac<span class="log">(</span>startAng<span class="log">)</span><span class="log">)</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">arc</span><span class="log">(</span>x, y, r, <span class="title">drac<span class="log">(</span></span>startAng<span class="log">)</span>, <span class="title">drac<span class="log">(</span></span>endAng<span class="log">)</span>, <span class="let">false</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">moveTo</span><span class="log">(</span>x, y<span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">lineTo</span><span class="log">(</span>x <span class="let">+</span> r * Math<span class="log">.</span><span class="title1">cos</span><span class="log">(</span>drac<span class="log">(</span>endAng<span class="log">)</span><span class="log">)</span>, y <span class="let">+</span> r * Math<span class="log">.</span><span class="title1">sin</span><span class="log">(</span>drac<span class="log">(</span>endAng<span class="log">)</span><span class="log">)</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">fillStyle</span> <span class="let">=</span> fillColor;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">fill</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">closePath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">beginPath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">textAlign</span> <span class="let">=</span> <span class="string">"center"</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">textBaseline</span> <span class="let">=</span> <span class="string">"middle"</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">fillStyle</span> <span class="let">=</span> textColor;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">font</span> <span class="let">=</span> '16px 微软雅黑';</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">save</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">translate</span><span class="log">(</span>x <span class="let">+</span> r * Math<span class="log">.</span><span class="title1">cos</span><span class="log">(</span>drac<span class="log">(</span>startAng <span class="let">+</span> <span class="log">(</span>endAng <span class="let">-</span> startAng<span class="log">)</span> / 2<span class="log">)</span><span class="log">)</span> / 2, y <span class="let">+</span> r * Math<span class="log">.</span><span class="title1">sin</span><span class="log">(</span>drac<span class="log">(</span>startAng <span class="let">+</span> <span class="log">(</span>endAng <span class="let">-</span> startAng<span class="log">)</span> / 2<span class="log">)</span><span class="log">)</span> / 2<span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">rotate</span><span class="log">(</span>drac<span class="log">(</span>startAng <span class="let">+</span> <span class="log">(</span>endAng <span class="let">-</span> startAng<span class="log">)</span> / 2<span class="log">)</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">fillText</span><span class="log">(</span>text, 0, 0<span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">restore</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">closePath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'><span class="let">    let </span>x <span class="let">=</span> canvasWidth / 2,</code><code data-key='xmp'>        y <span class="let">=</span> canvasHeight / 2 <span class="let">-</span> 50,</code><code data-key='xmp'>        r <span class="let">=</span> 200;</code><code data-key='xmp'>    //<span class="let"> let </span>data <span class="let">=</span> [<span class="log">{</span></code><code data-key='xmp'>    <span class="green">//startAng: 30,</span></code><code data-key='xmp'>    <span class="green">//endAng: 80,</span></code><code data-key='xmp'>    <span class="green">//color: </span><span class="string">"pink"</span>,</code><code data-key='xmp'>    <span class="green">//text: </span><span class="string">"一等神秘奖"</span></code><code data-key='xmp'>    <span class="green">//<span class="log">}</span>, <span class="log">{</span></span></code><code data-key='xmp'>    <span class="green">//startAng: 80,</span></code><code data-key='xmp'>    <span class="green">//endAng: 140,</span></code><code data-key='xmp'>    <span class="green">//color: </span><span class="string">"#DC143C"</span>,</code><code data-key='xmp'>    <span class="green">//text: </span><span class="string">"再转一次"</span></code><code data-key='xmp'>    <span class="green">//<span class="log">}</span>, <span class="log">{</span></span></code><code data-key='xmp'>    <span class="green">//startAng: 140,</span></code><code data-key='xmp'>    <span class="green">//endAng: 230,</span></code><code data-key='xmp'>    <span class="green">//color: </span><span class="string">"#9400D3"</span>,</code><code data-key='xmp'>    <span class="green">//text: </span><span class="string">"满10块减5块"</span></code><code data-key='xmp'>    <span class="green">//<span class="log">}</span>, <span class="log">{</span></span></code><code data-key='xmp'>    <span class="green">//startAng: 230,</span></code><code data-key='xmp'>    <span class="green">//endAng: 360,</span></code><code data-key='xmp'>    <span class="green">//color: </span><span class="string">"#6495ED"</span>,</code><code data-key='xmp'>    <span class="green">//text: </span><span class="string">"谢谢惠顾"</span></code><code data-key='xmp'>    <span class="green">//<span class="log">}</span>, <span class="log">{</span></span></code><code data-key='xmp'>    <span class="green">//startAng: 0,</span></code><code data-key='xmp'>    <span class="green">//endAng: 30,</span></code><code data-key='xmp'>    <span class="green">//color: </span><span class="string">"#00FF7F"</span>,</code><code data-key='xmp'>    <span class="green">//text: </span><span class="string">"满100减120"</span></code><code data-key='xmp'>    <span class="green">//<span class="log">}</span>];</span></code><code data-key='xmp'><span class="let">    let </span>title <span class="let">=</span> <span class="string">"今日份回家干什么"</span>;</code><code data-key='xmp'><span class="let">    let </span>data <span class="let">=</span> [<span class="log">{</span></code><code data-key='xmp'>        startAng: 0,</code><code data-key='xmp'>        endAng: 20,</code><code data-key='xmp'>        text: <span class="string">"写页面"</span>,</code><code data-key='xmp'>        color: <span class="string">"#00FF7F"</span></code><code data-key='xmp'>    <span class="log">}</span>, <span class="log">{</span></code><code data-key='xmp'>        startAng: 20,</code><code data-key='xmp'>        endAng: 360,</code><code data-key='xmp'>        text: <span class="string">"刷视频"</span>,</code><code data-key='xmp'>        color: <span class="string">"#6495ED"</span></code><code data-key='xmp'>    <span class="log">}</span>];</code><code data-key='xmp'><span class="let">    let </span>rotateNums <span class="let">=</span> Math<span class="log">.</span><span class="title1">random</span><span class="log">(</span><span class="log">)</span> * 1000,</code><code data-key='xmp'>        count <span class="let">=</span> 0;</code><code data-key='xmp'><span class="let">    let </span>arc <span class="let">=</span> 0;</code><code data-key='xmp'>    <span class="green">//<span class="title">requestAnimationFrame<span class="log">(</span></span>loop<span class="log">)</span>;</span></code><code data-key='xmp'>    <span class='let'>function</span> <span class="title">winPrizeIs<span class="log">(</span></span>text<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">beginPath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">fillStyle</span> <span class="let">=</span> <span class="string">"#000"</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">fillText</span><span class="log">(</span>text, canvasWidth / 2, 100<span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">closePath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>    <span class='let'>function</span> <span class="title">gameOver<span class="log">(</span></span><span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>        <span class="green">//游戏结束</span></code><code data-key='xmp'>        gameStatus <span class="let">=</span> <span class="string">"over"</span>;</code><code data-key='xmp'>        <span class="title">drawStartBtn<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'><span class="let">        let </span>rotate <span class="let">=</span> arc % 360;</code><code data-key='xmp'>        for <span class="log">(</span><span class="let">let </span>item <span class="let">of</span> data<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>            if <span class="log">(</span><span class="log">(</span>item<span class="log">.</span><span class="title1">startAng</span> <span class="let">+</span> rotate<span class="log">)</span> % 360 <span class='angleBracket'>&lt;</span><span class='elName'>=</span> 90 && (item.endAng + rotate) % 360 <span class='angleBracket'>&gt;</span><span class="let">=</span> 90<span class="let"> || </span><span class="log">(</span><span class="log">(</span>item<span class="log">.</span><span class="title1">startAng</span> <span class="let">+</span> rotate<span class="log">)</span> % 360<span class="let"> >= </span>90 <span class="let">&</span><span class="let">&</span> <span class="log">(</span>item<span class="log">.</span><span class="title1">endAng</span> <span class="let">+</span> rotate<span class="log">)</span> % 360<span class="log">)</span><span class="let"> >= </span>90 <span class="let">&</span><span class="let">&</span> <span class="log">(</span>item<span class="log">.</span><span class="title1">endAng</span> <span class="let">+</span> rotate<span class="log">)</span> % 360<span class="let"> <= </span><span class="log">(</span>item<span class="log">.</span><span class="title1">startAng</span> <span class="let">+</span> rotate<span class="log">)</span> % 360<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>                <span class="title">winPrizeIs<span class="log">(</span></span>item<span class="log">.</span><span class="title1">text</span><span class="log">)</span>;</code><code data-key='xmp'>            <span class="log">}</span></code><code data-key='xmp'>        <span class="log">}</span></code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>    <span class='let'>function</span> <span class="title">drawTitle<span class="log">(</span></span><span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">font</span> <span class="let">=</span> <span class="string">"20px bold 宋体"</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">textAlign</span> <span class="let">=</span> <span class="string">"center"</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">textBaseline</span> <span class="let">=</span> <span class="string">"middle"</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">fillText</span><span class="log">(</span>title, canvasWidth / 2, 50<span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>    <span class='let'>function</span> <span class="title">loop<span class="log">(</span></span><span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>        if <span class="log">(</span>count<span class="let"> >= </span>rotateNums<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>            <span class="title">gameOver<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>            <span class="let">return</span>;</code><code data-key='xmp'>        <span class="log">}</span></code><code data-key='xmp'>        count<span class="let">+</span><span class="let">+</span>;</code><code data-key='xmp'>        arc <span class="let">+</span><span class="let">=</span> 50 * Math<span class="log">.</span><span class="title1">random</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">clearRect</span><span class="log">(</span>0, 0, canvasWidth, canvasHeight<span class="log">)</span>;</code><code data-key='xmp'>        <span class="title">drawTitle<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>        for <span class="log">(</span><span class="let">let </span>item <span class="let">of</span> data<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>            <span class="title">drawPieChart<span class="log">(</span></span>x, y, r, item<span class="log">.</span><span class="title1">color</span>, item<span class="log">.</span><span class="title1">startAng</span> <span class="let">+</span> arc, item<span class="log">.</span><span class="title1">endAng</span> <span class="let">+</span> arc, item<span class="log">.</span><span class="title1">text</span><span class="log">)</span>;</code><code data-key='xmp'>        <span class="log">}</span></code><code data-key='xmp'>        <span class="title">drawPointer<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>        <span class="title">requestAnimationFrame<span class="log">(</span></span>loop<span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>    <span class='let'>function</span> <span class="title">drawPointer<span class="log">(</span></span><span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">beginPath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">fillStyle</span> <span class="let">=</span> <span class="string">"rgba(0,0,0,0.5)"</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">arc</span><span class="log">(</span>x, y, r, 0, <span class="title">drac<span class="log">(</span></span>360<span class="log">)</span>, <span class="let">false</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">fill</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">closePath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">beginPath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">moveTo</span><span class="log">(</span>x, y<span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">lineTo</span><span class="log">(</span>x, y <span class="let">+</span> r * 0<span class="log">.</span><span class="title1">8</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">moveTo</span><span class="log">(</span>x, y <span class="let">+</span> r * 0<span class="log">.</span><span class="title1">8</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">lineTo</span><span class="log">(</span>x <span class="let">+</span> 10, y <span class="let">+</span> r * 0<span class="log">.</span><span class="title1">8</span> <span class="let">-</span> Math<span class="log">.</span><span class="title1">sqrt</span><span class="log">(</span>200<span class="log">)</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">moveTo</span><span class="log">(</span>x, y <span class="let">+</span> r * 0<span class="log">.</span><span class="title1">8</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">lineTo</span><span class="log">(</span>x <span class="let">-</span> 10, y <span class="let">+</span> r * 0<span class="log">.</span><span class="title1">8</span> <span class="let">-</span> Math<span class="log">.</span><span class="title1">sqrt</span><span class="log">(</span>200<span class="log">)</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">strokeStyle</span> <span class="let">=</span> <span class="string">"#BC8F8F"</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">lineWidth</span> <span class="let">=</span> 2;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">stroke</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'><span class="let">    let </span>btnW <span class="let">=</span> 120,</code><code data-key='xmp'>        btnH <span class="let">=</span> 40,</code><code data-key='xmp'>        btnY <span class="let">=</span> 650;</code><code data-key='xmp'>    <span class='let'>function</span> <span class="title">drawStartBtn<span class="log">(</span></span><span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">beginPath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">rect</span><span class="log">(</span><span class="log">(</span>canvasWidth <span class="let">-</span> btnW<span class="log">)</span> / 2, btnY, btnW, btnH<span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">fillStyle</span> <span class="let">=</span> <span class="string">"#BC8F8F"</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">fill</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">font</span> <span class="let">=</span> <span class="string">"18px 宋体"</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">fillStyle</span> <span class="let">=</span> <span class="string">"#F5F5F5"</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">fillText</span><span class="log">(</span><span class="string">"开始游戏"</span>, <span class="log">(</span>canvasWidth <span class="let">-</span> 120<span class="log">)</span> / 2 <span class="let">+</span> btnW / 2, btnY <span class="let">+</span> btnH / 2<span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">textAlign</span> <span class="let">=</span> <span class="string">"center"</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">textBaseline</span> <span class="let">=</span> <span class="string">"middle"</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">closePath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>    <span class='let'>function</span> <span class="title">gameInit<span class="log">(</span></span><span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>        <span class="title">drawTitle<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>        for <span class="log">(</span><span class="let">let </span>item <span class="let">of</span> data<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>            <span class="title">drawPieChart<span class="log">(</span></span>x, y, r, item<span class="log">.</span><span class="title1">color</span>, item<span class="log">.</span><span class="title1">startAng</span> <span class="let">+</span> arc, item<span class="log">.</span><span class="title1">endAng</span> <span class="let">+</span> arc, item<span class="log">.</span><span class="title1">text</span><span class="log">)</span>;</code><code data-key='xmp'>        <span class="log">}</span></code><code data-key='xmp'>        <span class="title">drawPointer<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>        <span class="title">drawStartBtn<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>    <span class="title">gameInit<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>    <span class='let'>function</span> <span class="title">gameStart<span class="log">(</span></span>ev<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'><span class="let">        let </span>offsetX <span class="let">=</span> ev<span class="log">.</span><span class="title1">offsetX</span>,</code><code data-key='xmp'>            offsetY <span class="let">=</span> ev<span class="log">.</span><span class="title1">offsetY</span>;</code><code data-key='xmp'>        if <span class="log">(</span>offsetX<span class="let"> >= </span><span class="log">(</span>canvasWidth / 2 <span class="let">-</span> btnW / 2<span class="log">)</span> <span class="let">&</span><span class="let">&</span> offsetX <span class='angleBracket'>&lt;</span><span class='elName'>=</span> (canvasWidth / 2 + btnW / 2) && offsetY <= btnY + btnH && offsetY <span class='angleBracket'>&gt;</span><span class="let">=</span> btnY<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>            <span class="green">//点击开始游戏按钮</span></code><code data-key='xmp'>            if <span class="log">(</span>gameStatus <span class="let">===</span> <span class="string">"start"</span><span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>                <span class="let">return</span>;</code><code data-key='xmp'>            <span class="log">}</span></code><code data-key='xmp'>            if <span class="log">(</span>count <span class="let">!</span><span class="let">=</span> 0<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>                rotateNums <span class="let">=</span> Math<span class="log">.</span><span class="title1">random</span><span class="log">(</span><span class="log">)</span> * 1000;</code><code data-key='xmp'>                while <span class="log">(</span>rotateNums<span class="let"> < </span>100<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>                    rotateNums <span class="let">=</span> Math<span class="log">.</span><span class="title1">random</span><span class="log">(</span><span class="log">)</span> * 1000;</code><code data-key='xmp'>                <span class="log">}</span></code><code data-key='xmp'>                count <span class="let">=</span> 0;</code><code data-key='xmp'>            <span class="log">}</span></code><code data-key='xmp'>            gameStatus <span class="let">=</span> <span class="string">"start"</span>;</code><code data-key='xmp'>            <span class="title">requestAnimationFrame<span class="log">(</span></span>loop<span class="log">)</span>;</code><code data-key='xmp'>        <span class="log">}</span></code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>    canvas<span class="log">.</span><span class="title1">addEventListener</span><span class="log">(</span><span class="string">"click"</span>, gameStart, <span class="let">false</span><span class="log">)</span>;</code></div></pre><h4 id='效果' class='Mh435183'>效果</h4><img class="uploadImg" data-key="img" src="./imgs/upload_00832c9cdf9f5dd2926c7caffb8d788b.gif"/><h3 id='drawImage' class='bG722132'>drawImage</h3><h4 id='使用方法' class='cL974331'>使用方法</h4><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//ctx<span class="log">.</span><span class="title1">drawImage</span><span class="log">(</span>相对应的图片dom或者vedio视频或者canvas，图片上的x轴，图片上的y轴，取图片上的宽，取图片上的高，canvas上的x点，canvas上的y点，画在canvas上面的宽度，画在canvas上面的高度<span class="log">)</span></span></code><code data-key='xmp'><span class="let">let </span>canvas <span class="let">=</span> document<span class="log">.</span><span class="title1">querySelector</span><span class="log">(</span><span class="string">"#canvas"</span><span class="log">)</span>,</code><code data-key='xmp'>        ctx <span class="let">=</span> canvas<span class="log">.</span><span class="title1">getContext</span><span class="log">(</span><span class="string">"2d"</span><span class="log">)</span>,</code><code data-key='xmp'>        canvasHeight <span class="let">=</span> canvas<span class="log">.</span><span class="title1">offsetHeight</span>,</code><code data-key='xmp'>        canvasWidth <span class="let">=</span> canvas<span class="log">.</span><span class="title1">offsetWidth</span>;</code><code data-key='xmp'><span class="let">let </span>image <span class="let">=</span><span class="let"> new </span><span class="title">Image<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>    image<span class="log">.</span><span class="title1">src</span>=<span class="string">"./1.jpeg"</span>;</code><code data-key='xmp'>    image<span class="log">.</span><span class="title1">onload</span> <span class="let">=</span> <span class="title"><span class='let'>function</span><span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>       ctx<span class="log">.</span><span class="title1">drawImage</span><span class="log">(</span>this,200,200,600,400,0,0,canvasWidth / 2,canvasHeight / 2<span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code></div></pre><h4 id='效果' class='AB450066'>效果</h4><img class="uploadImg" data-key="img" src="./imgs/upload_a3a85919bc05075d57bdfc0ed20312a1.PNG"/><h4 id='原图' class='CZ641542'>原图</h4><img class="uploadImg" data-key="img" src="./imgs/upload_317bc1a615f000516db2a2f0db39c8c8.jpeg"/><h3 id='canvas遮罩 -> globalCompositeOperation属性' class='Gc876249'>canvas遮罩 -> globalCompositeOperation属性</h3><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//这个是用一个图形取遮罩一个图形</span></code><code data-key='xmp'><span class="green">//主要常用就两个属性值 destination<span class="let">-</span>in 显示图形遮罩里面的内容</span></code><code data-key='xmp'><span class="green">//destination<span class="let">-</span>out显示遮罩图形外面的内容</span></code></div></pre><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div></div><div class="codePre"><code data-key='xmp'><span class="let">let </span>canvas <span class="let">=</span> document<span class="log">.</span><span class="title1">querySelector</span><span class="log">(</span><span class="string">"#canvas"</span><span class="log">)</span>,</code><code data-key='xmp'>    ctx <span class="let">=</span> canvas<span class="log">.</span><span class="title1">getContext</span><span class="log">(</span><span class="string">"2d"</span><span class="log">)</span>,</code><code data-key='xmp'>    canvasHeight <span class="let">=</span> canvas<span class="log">.</span><span class="title1">offsetHeight</span>,</code><code data-key='xmp'>    canvasWidth <span class="let">=</span> canvas<span class="log">.</span><span class="title1">offsetWidth</span>;</code><code data-key='xmp'><span class="let">let </span>image <span class="let">=</span><span class="let"> new </span><span class="title">Image<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>    image<span class="log">.</span><span class="title1">src</span>=<span class="string">"./1.jpeg"</span>;</code><code data-key='xmp'>    image<span class="log">.</span><span class="title1">onload</span> <span class="let">=</span> <span class="title"><span class='let'>function</span><span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">drawImage</span><span class="log">(</span>this,0,0,canvasWidth,canvasHeight<span class="log">)</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">globalCompositeOperation</span> <span class="let">=</span> <span class="string">"destination-in"</span>;</code><code data-key='xmp'>        <span class="green">//ctx<span class="log">.</span><span class="title1">globalCompositeOperation</span> <span class="let">=</span> </span><span class="string">"destination-out"</span>;</code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">fillRect</span><span class="log">(</span>canvasWidth / 2 <span class="let">-</span> 100,canvasHeight / 2 <span class="let">-</span> 50,200,100<span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code></div></pre><h4 id='效果图' class='eb812807'>效果图</h4><div><div class='quote'>destination-in</div></div><img class="uploadImg" data-key="img" src="./imgs/upload_54d16331da0e8912836ce7f26a32af5a.PNG"/><div><div class='quote'>destination-out</div></div><img class="uploadImg" data-key="img" src="./imgs/upload_a7eca58a509e5ae15fd80252a3ead6d0.PNG"/><div><div class='quote'>这个中间的白色矩形是canvas的背景,不是矩形的颜色,矩形是黑色的</div></div><div><div class='quote'>原图</div></div><img class="uploadImg" data-key="img" src="./imgs/upload_d571ae385338e6f784f21b56397d4760.PNG"/><h3 id='canvas操作像素点' class='GG985272'>canvas操作像素点</h3><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//通过getImageData获取到canvas身上指定范围的像素点,总共像素点里包括了 高 * 宽 * 4,一个像素占四个,分别是r,g,b,a</span></code><code data-key='xmp'><span class="green">//ctx<span class="log">.</span><span class="title1">getImageData</span><span class="log">(</span>0,0,canvasWidth,canvasHeight<span class="log">)</span>;获取canvas身上所有的像素点</span></code><code data-key='xmp'><span class="green">//最后将操作完成的像素点再通过putImageData赋值给canvas</span></code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">putImageData</span><span class="log">(</span>开始通过getImageData拿到的像素点对象,操作点x,操作点y<span class="log">)</span></code><code data-key='xmp'><span class="green">//这一系列操作不能在本地演示,需要通过服务器操作才能拿到ImageData</span></code></div></pre><h4 id='代码演示' class='HC917791'>代码演示</h4><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div></div><div class="codePre"><code data-key='xmp'><span class="let">let </span>canvas <span class="let">=</span> document<span class="log">.</span><span class="title1">getElementById</span><span class="log">(</span><span class="string">"canvas"</span><span class="log">)</span>,</code><code data-key='xmp'>    ctx <span class="let">=</span> canvas<span class="log">.</span><span class="title1">getContext</span><span class="log">(</span><span class="string">"2d"</span><span class="log">)</span>,</code><code data-key='xmp'>    canvasWidth <span class="let">=</span> canvas<span class="log">.</span><span class="title1">offsetWidth</span>,   </code><code data-key='xmp'>    canvasHeight <span class="let">=</span> canvas<span class="log">.</span><span class="title1">offsetHeight</span>;</code><code data-key='xmp'><span class="let">let </span>img <span class="let">=</span><span class="let"> new </span><span class="title">Image<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>    img<span class="log">.</span><span class="title1">src</span> <span class="let">=</span> <span class="string">"http://localhost/1.jpeg"</span>;</code><code data-key='xmp'>    img<span class="log">.</span><span class="title1">onload</span> <span class="let">=</span> <span class="title"><span class='let'>function</span><span class="log">(</span></span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">drawImage</span><span class="log">(</span>this,0,0,canvasWidth,canvasHeight<span class="log">)</span>;</code><code data-key='xmp'><span class="let">let </span>imageData <span class="let">=</span> ctx<span class="log">.</span><span class="title1">getImageData</span><span class="log">(</span>0,0,canvasWidth / 2,canvasHeight / 2<span class="log">)</span>;</code><code data-key='xmp'>      <span class="title"><span class="let">for</span><span class="log">(</span></span><span class="let">let </span>i <span class="let">=</span> 0;i<span class="let"> < </span>imageData[<span class="string">"data"</span>]<span class="log">.</span>length;i<span class="let">+</span>=4<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>	imageData[<span class="string">"data"</span>][i] <span class="let">=</span> imageData[<span class="string">"data"</span>][i<span class="let">+</span>1] <span class="let">=</span> imageData[<span class="string">"data"</span>][i<span class="let">+</span>2]=<span class="log">(</span>imageData[<span class="string">"data"</span>][i] <span class="let">+</span> imageData[<span class="string">"data"</span>][i<span class="let">+</span>1] <span class="let">+</span> imageData[<span class="string">"data"</span>][i<span class="let">+</span>2]<span class="log">)</span> / 3;</code><code data-key='xmp'>      <span class="log">}</span></code><code data-key='xmp'>	ctx<span class="log">.</span><span class="title1">putImageData</span><span class="log">(</span>imageData,0,0<span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code></div></pre><h4 id='效果' class='NY935745'>效果</h4><img class="uploadImg" data-key="img" src="./imgs/upload_6c3bb884ff644ad7927c6758409b3064.PNG"/><div><div class='quote'>将该图片的四分之一改了,让rgb的值都是一样的,所以就是灰色的了,这个功能很强大,可以每个像素点操作</div></div><h3 id='canvas转成base64传到服务器案例' class='Lh111400'>canvas转成base64传到服务器案例</h3><div><div class='quote'>将canvas转成图片通过canvas.toDataURL("image/图片类型")</div></div><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div style='height: 14px;'></div><div style='height: 14px;'></div><div style='height: 14px;'></div><div style='height: 14px;'></div><div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div><div class='index'>19.</div><div class='index'>20.</div><div class='index'>21.</div><div class='index'>22.</div><div class='index'>23.</div><div class='index'>24.</div><div class='index'>25.</div><div class='index'>26.</div><div class='index'>27.</div><div class='index'>28.</div><div class='index'>29.</div><div class='index'>30.</div><div class='index'>31.</div><div class='index'>32.</div><div class='index'>33.</div><div class='index'>34.</div><div class='index'>35.</div><div class='index'>36.</div><div class='index'>37.</div><div class='index'>38.</div><div class='index'>39.</div><div class='index'>40.</div><div class='index'>41.</div><div class='index'>42.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//首先思路是这样的，将canvas转换成base64传到服务器保存，然后再通过服务器返回的图片地址用a标签自带的请求去下载相应文件</span></code><code data-key='xmp'><span class="green">//前端代码</span></code><code data-key='xmp'><span class="let">let </span>canvas <span class="let">=</span> document<span class="log">.</span><span class="title1">getElementById</span><span class="log">(</span><span class="string">"canvas"</span><span class="log">)</span>,</code><code data-key='xmp'>        ctx <span class="let">=</span> canvas<span class="log">.</span><span class="title1">getContext</span><span class="log">(</span><span class="string">"2d"</span><span class="log">)</span>,</code><code data-key='xmp'>        canvasWidth <span class="let">=</span> canvas<span class="log">.</span><span class="title1">offsetWidth</span>,</code><code data-key='xmp'>        canvasHeight <span class="let">=</span> canvas<span class="log">.</span><span class="title1">offsetHeight</span>;</code><code data-key='xmp'><span class="let">    let </span>img <span class="let">=</span><span class="let"> new </span><span class="title">Image<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>    img<span class="log">.</span><span class="title1">src</span> <span class="let">=</span> <span class="string">"http://localhost/1.jpeg"</span>;</code><code data-key='xmp'>    img<span class="log">.</span><span class="title1">onload</span> <span class="let">=</span> <span class="title"><span class='let'>function</span><span class="log">(</span></span><span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">drawImage</span><span class="log">(</span>this, 0, 0, canvasWidth, canvasHeight<span class="log">)</span>;</code><code data-key='xmp'><span class="let">        let </span>imageData <span class="let">=</span> ctx<span class="log">.</span><span class="title1">getImageData</span><span class="log">(</span>0, 0, canvasWidth / 2, canvasHeight / 2<span class="log">)</span>;</code><code data-key='xmp'>        for <span class="log">(</span><span class="let">let </span>i <span class="let">=</span> 0; i<span class="let"> < </span>imageData[<span class="string">"data"</span>]<span class="log">.</span>length; i <span class="let">+</span><span class="let">=</span> 4<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>            imageData[<span class="string">"data"</span>][i] <span class="let">=</span> imageData[<span class="string">"data"</span>][i <span class="let">+</span> 1] <span class="let">=</span> imageData[<span class="string">"data"</span>][i <span class="let">+</span> 2] <span class="let">=</span> <span class="log">(</span>imageData[<span class="string">"data"</span>][i] <span class="let">+</span> imageData[<span class="string">"data"</span>][i <span class="let">+</span> 1] <span class="let">+</span> imageData[<span class="string">"data"</span>][i <span class="let">+</span> 2]<span class="log">)</span> / 3;</code><code data-key='xmp'>        <span class="log">}</span></code><code data-key='xmp'>        ctx<span class="log">.</span><span class="title1">putImageData</span><span class="log">(</span>imageData, 0, 0<span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>    <span class='let'>function</span> <span class="title">uploadFile<span class="log">(</span></span>file, url<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'><span class="let">        let </span>form <span class="let">=</span><span class="let"> new </span><span class="title">FormData<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>        form<span class="log">.</span><span class="title1">append</span><span class="log">(</span><span class="string">"file"</span>, file<span class="log">)</span>;</code><code data-key='xmp'><span class="let">        let </span>xhr <span class="let">=</span><span class="let"> new </span><span class="title">XMLHttpRequest<span class="log">(</span></span><span class="log">)</span>;</code><code data-key='xmp'>        if <span class="log">(</span><span class="let">!</span>xhr<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>            xhr <span class="let">=</span><span class="let"> new </span><span class="title">ActiveXObject<span class="log">(</span></span><span class="string">"Microsoft.XMLHTTP"</span><span class="log">)</span>;</code><code data-key='xmp'>        <span class="log">}</span></code><code data-key='xmp'>        xhr<span class="log">.</span><span class="title1">open</span><span class="log">(</span><span class="string">"POST"</span>, url, <span class="let">false</span><span class="log">)</span>;</code><code data-key='xmp'>        xhr<span class="log">.</span><span class="title1">onreadystatechange</span> <span class="let">=</span> <span class="title"><span class='let'>function</span><span class="log">(</span></span><span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>            if <span class="log">(</span>xhr<span class="log">.</span><span class="title1">readyState</span> <span class="let">===</span> 4 <span class="let">&</span><span class="let">&</span> xhr<span class="log">.</span><span class="title1">status</span><span class="let"> >= </span>200 <span class="let">&</span><span class="let">&</span> xhr<span class="log">.</span><span class="title1">status</span><span class="let"> <= </span>304<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'><span class="let">                let </span>a <span class="let">=</span> document<span class="log">.</span><span class="title1">createElement</span><span class="log">(</span><span class="string">"a"</span><span class="log">)</span>;</code><code data-key='xmp'>                a<span class="log">.</span><span class="title1">setAttribute</span><span class="log">(</span><span class="string">"href"</span>,<span class="string">"http://localhost:8080/download?imageName="</span><span class="let">+</span>xhr<span class="log">.</span><span class="title1">responseText</span><span class="log">)</span>;</code><code data-key='xmp'>                a<span class="log">.</span><span class="title1">setAttribute</span><span class="log">(</span>'download',xhr<span class="log">.</span><span class="title1">reponseText</span><span class="log">)</span>;</code><code data-key='xmp'>                document<span class="log">.</span><span class="title1">body</span><span class="log">.</span><span class="title1">appendChild</span><span class="log">(</span>a<span class="log">)</span>;</code><code data-key='xmp'>                a<span class="log">.</span><span class="title1">click</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>                <span class="let">return</span>;</code><code data-key='xmp'>            <span class="log">}</span></code><code data-key='xmp'>        <span class="log">}</span></code><code data-key='xmp'>        xhr<span class="log">.</span><span class="title1">send</span><span class="log">(</span>form<span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'><span class="let">    let </span>save <span class="let">=</span> document<span class="log">.</span><span class="title1">querySelector</span><span class="log">(</span><span class="string">".save"</span><span class="log">)</span>;</code><code data-key='xmp'>    save<span class="log">.</span><span class="title1">addEventListener</span><span class="log">(</span><span class="string">"click"</span>, saveCanvasImage, <span class="let">false</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class='let'>function</span> <span class="title">saveCanvasImage<span class="log">(</span></span><span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'><span class="let">        let </span>base64 <span class="let">=</span> canvas<span class="log">.</span><span class="title1">toDataURL</span><span class="log">(</span><span class="string">"image/png"</span><span class="log">)</span>;</code><code data-key='xmp'>        <span class="title">uploadFile<span class="log">(</span></span>base64, <span class="string">"http://localhost:8080/base64"</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code></div></pre><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div style='height: 14px;'></div><div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div><div class='index'>19.</div><div class='index'>20.</div><div class='index'>21.</div><div class='index'>22.</div><div class='index'>23.</div><div class='index'>24.</div><div class='index'>25.</div><div class='index'>26.</div><div class='index'>27.</div><div class='index'>28.</div><div class='index'>29.</div><div class='index'>30.</div><div class='index'>31.</div><div class='index'>32.</div><div class='index'>33.</div><div class='index'>34.</div><div class='index'>35.</div><div class='index'>36.</div><div class='index'>37.</div><div class='index'>38.</div><div class='index'>39.</div><div class='index'>40.</div><div class='index'>41.</div><div class='index'>42.</div><div class='index'>43.</div><div class='index'>44.</div><div class='index'>45.</div><div class='index'>46.</div><div class='index'>47.</div><div class='index'>48.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//后端nodejs代码</span></code><code data-key='xmp'><span class="let">const </span>http <span class="let">=</span> <span class="title">require<span class="log">(</span></span><span class="string">"http"</span><span class="log">)</span>;</code><code data-key='xmp'><span class="let">const </span>fs <span class="let">=</span> <span class="title">require<span class="log">(</span></span><span class="string">"fs"</span><span class="log">)</span>;</code><code data-key='xmp'><span class="let">const </span>url <span class="let">=</span> <span class="title">require<span class="log">(</span></span><span class="string">"url"</span><span class="log">)</span>;</code><code data-key='xmp'><span class="let">const </span><span class="log">{</span>v4<span class="colonColor">: </span><span class="typeColor">uuidv4<span class="log">}</span></span> <span class="let">=</span> <span class="title">require<span class="log">(</span></span><span class="string">"uuid"</span><span class="log">)</span>;</code><code data-key='xmp'><span class="let">let </span>server <span class="let">=</span> http<span class="log">.</span><span class="title1">createServer</span><span class="log">(</span><span class="log">(</span>req, res<span class="log">)</span><span class="log"> => </span><span class="log">{</span></code><code data-key='xmp'>    res<span class="log">.</span><span class="title1">setHeader</span><span class="log">(</span><span class="string">"Access-Control-Allow-Origin"</span>,<span class="string">"*"</span><span class="log">)</span>;</code><code data-key='xmp'><span class="let">    let </span>pathname,params;</code><code data-key='xmp'>    <span class="title"><span class="let">if</span><span class="log">(</span></span>req<span class="log">.</span><span class="title1">method</span> <span class="let">===</span> <span class="string">"GET"</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'><span class="let">        let </span>query <span class="let">=</span> url<span class="log">.</span><span class="title1">parse</span><span class="log">(</span>req<span class="log">.</span><span class="title1">url</span>,true<span class="log">)</span>;</code><code data-key='xmp'>        params <span class="let">=</span> query<span class="log">.</span><span class="title1">query</span>;</code><code data-key='xmp'>        pathname <span class="let">=</span> query<span class="log">.</span><span class="title1">pathname</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>    if <span class="log">(</span>req<span class="log">.</span><span class="title1">url</span> <span class="let">===</span> <span class="string">"/base64"</span><span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'><span class="let">        let </span>arr <span class="let">=</span> [];</code><code data-key='xmp'>        req<span class="log">.</span><span class="title1">on</span><span class="log">(</span><span class="string">"data"</span>, data<span class="log"> => </span><span class="log">{</span></code><code data-key='xmp'>            arr<span class="log">.</span><span class="title1">push</span><span class="log">(</span>data<span class="log">)</span>;</code><code data-key='xmp'>        <span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'>        req<span class="log">.</span><span class="title1">on</span><span class="log">(</span><span class="string">"end"</span>, <span class="log">(</span><span class="log">)</span><span class="log"> => </span><span class="log">{</span></code><code data-key='xmp'><span class="let">            let </span>buffer <span class="let">=</span> Buffer<span class="log">.</span><span class="title1">concat</span><span class="log">(</span>arr<span class="log">)</span>;</code><code data-key='xmp'>            res<span class="log">.</span><span class="title1">setHeader</span><span class="log">(</span><span class="string">"Content-Type"</span>, <span class="string">"text/plain;charset=utf8"</span><span class="log">)</span>;</code><code data-key='xmp'>            <span class="title">saveImage<span class="log">(</span></span>buffer<span class="log">)</span>;</code><code data-key='xmp'>        <span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span><span class="let">else</span> if <span class="log">(</span>pathname <span class="let">===</span> <span class="string">"/download"</span> <span class="let">&</span><span class="let">&</span> req<span class="log">.</span><span class="title1">method</span> <span class="let">===</span> <span class="string">"GET"</span><span class="log">)</span><span class="log">{</span></code><code data-key='xmp'><span class="let">        let </span><span class="log">{</span>imageName<span class="log">}</span> <span class="let">=</span> params;</code><code data-key='xmp'>        fs<span class="log">.</span><span class="title1">readFile</span><span class="log">(</span>imageName,<span class="log">(</span>err,data<span class="log">)</span><span class="log"> => </span><span class="log">{</span></code><code data-key='xmp'>            <span class="title"><span class="let">if</span><span class="log">(</span></span>err<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>                res<span class="log">.</span><span class="title1">end</span><span class="log">(</span><span class="string">"获取失败"</span><span class="log">)</span>;</code><code data-key='xmp'>                <span class="let">return</span>;</code><code data-key='xmp'>            <span class="log">}</span></code><code data-key='xmp'>            res<span class="log">.</span><span class="title1">setHeader</span><span class="log">(</span>'Content<span class="let">-</span>Disposition', 'attachment; filename=' <span class="let">+</span> <span class="title">encodeURIComponent<span class="log">(</span></span>imageName<span class="log">)</span><span class="log">)</span>;</code><code data-key='xmp'>            res<span class="log">.</span><span class="title1">end</span><span class="log">(</span>data<span class="log">)</span>;</code><code data-key='xmp'>        <span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span></code><code data-key='xmp'>    <span class='let'>function</span> <span class="title">saveImage<span class="log">(</span></span>file<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'><span class="let">    let </span>imageName <span class="let">=</span> <span class="title">uuidv4<span class="log">(</span></span><span class="log">)</span> <span class="let">+</span> <span class="string">".png"</span>;</code><code data-key='xmp'>    console<span class="log">.</span><span class="title1">log</span><span class="log">(</span>file<span class="log">.</span><span class="title1">toString</span><span class="log">(</span><span class="log">)</span><span class="log">.</span><span class="title1">substring</span><span class="log">(</span>0,100<span class="log">)</span><span class="log">)</span>;</code><code data-key='xmp'>    fs<span class="log">.</span><span class="title1">writeFile</span><span class="log">(</span>imageName,file<span class="log">.</span><span class="title1">toString</span><span class="log">(</span><span class="log">)</span><span class="log">.</span><span class="title1">split</span><span class="log">(</span><span class="string">","</span><span class="log">)</span>[1],<span class="string">"base64"</span>,err<span class="log"> => </span><span class="log">{</span></code><code data-key='xmp'>        <span class="title"><span class="let">if</span><span class="log">(</span></span>err<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>            res<span class="log">.</span><span class="title1">end</span><span class="log">(</span><span class="string">"接收失败"</span><span class="log">)</span>;</code><code data-key='xmp'>            <span class="let">return</span>;</code><code data-key='xmp'>        <span class="log">}</span></code><code data-key='xmp'>        res<span class="log">.</span><span class="title1">writeHeader</span><span class="log">(</span>200,<span class="log">{</span><span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span><span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'>        res<span class="log">.</span><span class="title1">end</span><span class="log">(</span>imageName<span class="log">)</span>;</code><code data-key='xmp'>    <span class="log">}</span><span class="log">)</span></code><code data-key='xmp'><span class="log">}</span></code><code data-key='xmp'><span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'>server<span class="log">.</span><span class="title1">listen</span><span class="log">(</span>8080<span class="log">)</span>;</code></div></pre><h4 id='屏幕手机适配' class='aC291852'>屏幕手机适配</h4><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//设置canvas的宽度为屏幕宽度再乘以屏幕的分辨率，最后再使用scale缩小屏幕分辨率倍值,高度也是一样的，因为canvas画的是非矢量图，所以要和屏幕1:1，否则屏幕会造成失帧现象</span></code><code data-key='xmp'><span class="green">//js获取屏幕分辨率: window<span class="log">.</span><span class="title1">screen</span><span class="log">.</span><span class="title1">height</span>和window<span class="log">.</span><span class="title1">screen</span><span class="log">.</span><span class="title1">width</span></span></code><code data-key='xmp'><span class="green">//小程序: 先通过wx<span class="log">.</span><span class="title1">getSystemInfoSync</span><span class="log">(</span><span class="log">)</span>;然后通过<span class="log">.</span>pixelRatio得到屏幕的分辨率</span></code></div></pre><h4 id='小程序保存canvas' class='hF183621'>小程序保存canvas</h4><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div><div class='index'>10.</div><div class='index'>11.</div><div class='index'>12.</div><div class='index'>13.</div><div class='index'>14.</div><div class='index'>15.</div><div class='index'>16.</div><div class='index'>17.</div><div class='index'>18.</div><div class='index'>19.</div><div class='index'>20.</div><div class='index'>21.</div><div class='index'>22.</div><div class='index'>23.</div><div class='index'>24.</div><div class='index'>25.</div><div class='index'>26.</div><div class='index'>27.</div><div class='index'>28.</div><div class='index'>29.</div><div class='index'>30.</div><div class='index'>31.</div><div class='index'>32.</div><div class='index'>33.</div><div class='index'>34.</div><div class='index'>35.</div><div class='index'>36.</div><div class='index'>37.</div><div class='index'>38.</div><div class='index'>39.</div><div class='index'>40.</div><div class='index'>41.</div><div class='index'>42.</div><div class='index'>43.</div></div><div class="codePre"><code data-key='xmp'><span class="green">//首先通过wx<span class="log">.</span><span class="title1">canvasToTempFilePath</span>将canvas保存成图片</span></code><code data-key='xmp'><span class="green">//然后通过wx<span class="log">.</span><span class="title1">saveImageToPhotosAlbum</span>保存至本地</span></code><code data-key='xmp'><span class="green">//主要代码如下</span></code><code data-key='xmp'>wx<span class="log">.</span><span class="title1">showLoading</span><span class="log">(</span><span class="log">{</span></code><code data-key='xmp'>  title: '保存中',</code><code data-key='xmp'><span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'>wx<span class="log">.</span><span class="title1">canvasToTempFilePath</span><span class="log">(</span><span class="log">{</span></code><code data-key='xmp'>  x: 0,</code><code data-key='xmp'>  y: 0,</code><code data-key='xmp'>  canvas: canvas,</code><code data-key='xmp'>  width: canvasWidth,</code><code data-key='xmp'>  height: canvasHeight,</code><code data-key='xmp'>  <span class="title">success<span class="log">(</span></span>res<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>    console<span class="log">.</span><span class="title1">log</span><span class="log">(</span>res<span class="log">.</span><span class="title1">tempFilePath</span><span class="log">)</span>;</code><code data-key='xmp'>    if <span class="log">(</span>res<span class="log">.</span><span class="title1">errMsg</span><span class="log">.</span><span class="title1">indexOf</span><span class="log">(</span><span class="string">"ok"</span><span class="log">)</span> <span class="let">!</span><span class="let">=</span> 1<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>     wx<span class="log">.</span><span class="title1">saveImageToPhotosAlbum</span><span class="log">(</span><span class="log">{</span></code><code data-key='xmp'>       filePath: res<span class="log">.</span><span class="title1">tempFilePath</span>,</code><code data-key='xmp'>       <span class="title">success<span class="log">(</span></span>res<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>         wx<span class="log">.</span><span class="title1">hideLoading</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>         if <span class="log">(</span>res<span class="log">.</span><span class="title1">errMsg</span><span class="log">.</span><span class="title1">indexOf</span><span class="log">(</span><span class="string">"ok"</span><span class="log">)</span> <span class="let">!</span><span class="let">=</span> <span class="let">-</span>1<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>         wx<span class="log">.</span><span class="title1">showToast</span><span class="log">(</span><span class="log">{</span></code><code data-key='xmp'>           title: <span class="string">"保存成功"</span></code><code data-key='xmp'>         <span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'>         <span class="log">}</span></code><code data-key='xmp'>       <span class="log">}</span>,</code><code data-key='xmp'>       <span class="title">fail<span class="log">(</span></span>err<span class="log">)</span><span class="log">{</span></code><code data-key='xmp'>         wx<span class="log">.</span><span class="title1">hideLoading</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>         wx<span class="log">.</span><span class="title1">showToast</span><span class="log">(</span><span class="log">{</span></code><code data-key='xmp'>           title: <span class="string">"保存失败"</span></code><code data-key='xmp'>         <span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'>         console<span class="log">.</span><span class="title1">log</span><span class="log">(</span>err<span class="log">)</span>;</code><code data-key='xmp'>       <span class="log">}</span></code><code data-key='xmp'>     <span class="log">}</span><span class="log">)</span></code><code data-key='xmp'>     <span class="log">}</span></code><code data-key='xmp'>    <span class="log">}</span>,</code><code data-key='xmp'>    <span class="title">fail<span class="log">(</span></span>err<span class="log">)</span> <span class="log">{</span></code><code data-key='xmp'>    wx<span class="log">.</span><span class="title1">hideLoading</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>    wx<span class="log">.</span><span class="title1">showToast</span><span class="log">(</span><span class="log">{</span></code><code data-key='xmp'>      title: '保存失败',</code><code data-key='xmp'>    <span class="log">}</span><span class="log">)</span>;</code><code data-key='xmp'>    console<span class="log">.</span><span class="title1">log</span><span class="log">(</span>err<span class="log">)</span>;</code><code data-key='xmp'>   <span class="log">}</span></code><code data-key='xmp'><span class="log">}</span>, this<span class="log">)</span>;</code></div></pre><h4 id='canvas画字' class='cN498651'>canvas画字</h4><pre class='code' data-key='pre'>
                        <div class="code_header">
                          <div class="circle">
                           <div class="circle1"></div>
                           <div class="circle2"></div>
                           <div class="circle3"></div>
                          </div>
                          <svg title="复制" t="1649216860822" class="copy_code icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3280" width="24" height="24"><path d="M441.47 537.05h186.18v59.22H441.47zM441.47 671.04h280.56v59.22H441.47z" p-id="3281"></path><path d="M685.92 217.95c-0.62-0.65-1.27-1.25-1.93-1.84l-6.85-7.18h-9.52a29.56 29.56 0 0 0-6.31 0h-59.93l1.81-1.73-86.3-90.62H221.06a60.21 60.21 0 0 0-60.15 60.15V742.1a60.21 60.21 0 0 0 60.15 60.15h100.11v32.2a60.21 60.21 0 0 0 60.15 60.15h440.82a60.21 60.21 0 0 0 60.15-60.15V424L746.8 282z m93.95 184.69l-92.81-4.54a0.85 0.85 0 0 1-0.6-0.93l4.25-88.22 12.61 13.22zM221.06 743a1 1 0 0 1-0.93-0.93V176.73a1 1 0 0 1 0.93-0.93h270.45l31.55 33.13H381.32a60.21 60.21 0 0 0-60.15 60.15V743z m601.09 92.35H381.32a1 1 0 0 1-0.93-0.93V269.08a1 1 0 0 1 0.93-0.93h252.07l-6.08 126.27v0.12c-1.46 33.12 24.17 61.25 57 62.71L823.07 464v370.45a1 1 0 0 1-0.93 0.93z" p-id="3282"></path></svg>
                        </div>
                        <div class='indexPre'><div class='index'>1.</div><div class='index'>2.</div><div class='index'>3.</div><div class='index'>4.</div><div class='index'>5.</div><div class='index'>6.</div><div class='index'>7.</div><div class='index'>8.</div><div class='index'>9.</div></div><div class="codePre"><code data-key='xmp'><span class="let">let </span>canvas <span class="let">=</span> <span class="log">.</span><span class="log">.</span><span class="log">.</span>,ctx <span class="let">=</span> canvas<span class="log">.</span><span class="title1">getContext</span><span class="log">(</span><span class="string">"2d"</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">beginPath</span><span class="log">(</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">fillStyle</span> <span class="let">=</span> '';<span class="green">//设置绘制字体颜色,实体字用到</span></code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">font</span>=<span class="string">"fontStyle fontWeight fontSize fontFamily"</span>;<span class="green">//后面还有一些,但是我是没用过</span></code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">textAlign</span> <span class="let">=</span> <span class="string">"center"</span>;<span class="green">//水平居中</span></code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">textBaseLine</span> <span class="let">=</span> <span class="string">"middle"</span>;<span class="green">//垂直居中</span></code><code data-key='xmp'><span class="green">//上面两个操作起始就是将字体的绘制位置放到了中奖</span></code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">fillText</span><span class="log">(</span><span class="string">"要绘制的字"</span>,<span class="string">"绘制字的水平中点"</span>,<span class="string">"绘制字的垂直中点"</span><span class="log">)</span>;</code><code data-key='xmp'>ctx<span class="log">.</span><span class="title1">closePath</span><span class="log">(</span><span class="log">)</span>;</code></div></pre><img class="uploadImg" data-key="img" src="./imgs/hanucurzlr5lqaaaaaelftksuqmcc.png"/><img class="uploadImg" data-key="img" src="./imgs/cybe9u4o2mfaaaaabjru5erkjggg.png"/>
                </div>
                <div class="rightDraw">
                <div class="menu"><div class="directory">目录</div><ul class="menuCon"><li class="menu_li"><a href="#web前端绘图之canvas" id="bj224919" class="">web前端绘图之canvas</a><ul class="menuCon_1"><li class="menu_li0"><a href="#canvas标签" id="LB573134">canvas标签</a><ul class="menuCon_2"><li class="menu_li0"><a href="#html部分" id="Ki148014">html部分</a></li><li class="menu_li1"><a href="#js获取canvas画一个线" id="NF480274">js获取canvas画一个线</a></li><li class="menu_li2"><a href="#效果" id="hF999340">效果</a></li></ul></li><li class="menu_li1"><a href="#矩形" id="NG679826">矩形</a></li><li class="menu_li2"><a href="#圆" id="DA715644">圆</a><ul class="menuCon_3"><li class="menu_li0"><a href="#例子" id="ac347557">例子</a></li><li class="menu_li1"><a href="#效果" id="fZ462748">效果</a></li><li class="menu_li2"><a href="#画饼图案例" id="GF829428">画饼图案例</a></li><li class="menu_li3"><a href="#效果" id="DG397220">效果</a></li></ul></li><li class="menu_li3"><a href="#transform" id="XA025064">transform</a><ul class="menuCon_4"><li class="menu_li0"><a href="#物体不按照中心旋转解决" id="GF437467">物体不按照中心旋转解决</a></li><li class="menu_li1"><a href="#代码" id="Kg363682">代码</a></li><li class="menu_li2"><a href="#效果显示" id="Dh887037">效果显示</a></li><li class="menu_li3"><a href="#抽奖案例" id="Dg940671">抽奖案例</a></li><li class="menu_li4"><a href="#效果" id="Mh435183">效果</a></li></ul></li><li class="menu_li4"><a href="#drawImage" id="bG722132">drawImage</a><ul class="menuCon_5"><li class="menu_li0"><a href="#使用方法" id="cL974331">使用方法</a></li><li class="menu_li1"><a href="#效果" id="AB450066">效果</a></li><li class="menu_li2"><a href="#原图" id="CZ641542">原图</a></li></ul></li><li class="menu_li5"><a href="#canvas遮罩 -> globalCompositeOperation属性" id="Gc876249">canvas遮罩 -&gt; globalCompositeOperation属性</a><ul class="menuCon_6"><li class="menu_li0"><a href="#效果图" id="eb812807">效果图</a></li></ul></li><li class="menu_li6"><a href="#canvas操作像素点" id="GG985272">canvas操作像素点</a><ul class="menuCon_7"><li class="menu_li0"><a href="#代码演示" id="HC917791">代码演示</a></li><li class="menu_li1"><a href="#效果" id="NY935745">效果</a></li></ul></li><li class="menu_li7"><a href="#canvas转成base64传到服务器案例" id="Lh111400">canvas转成base64传到服务器案例</a><ul class="menuCon_8"><li class="menu_li0"><a href="#屏幕手机适配" id="aC291852">屏幕手机适配</a></li><li class="menu_li1"><a href="#小程序保存canvas" id="hF183621">小程序保存canvas</a></li><li class="menu_li2"><a href="#canvas画字" id="cN498651">canvas画字</a></li></ul></li></ul></li></ul></div>
                </div>
              </div>
           </div>
           <svg t="1648304059372" class="icon up" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3132" width="200" height="200"><path d="M832 64 192 64C121.6 64 64 121.6 64 192l0 640c0 70.4 57.6 128 128 128l640 0c70.4 0 128-57.6 128-128L960 192C960 121.6 902.4 64 832 64zM762.24 759.04c-12.8 12.8-33.28 12.8-45.44 0L513.92 560l-202.24 199.04c-12.8 12.8-33.28 12.8-45.44 0-12.8-12.8-12.8-32.64 0-45.44l224-220.16c6.4-6.4 15.36-9.6 24.32-8.96C522.88 483.84 531.2 487.04 538.24 493.44l224 220.16C775.04 726.4 775.04 746.24 762.24 759.04zM762.24 503.04c-12.8 12.8-33.28 12.8-45.44 0L513.92 304 311.68 503.04c-12.8 12.8-33.28 12.8-45.44 0-12.8-12.8-12.8-32.64 0-45.44l224-220.16c6.4-6.4 15.36-9.6 24.32-8.96C522.88 227.84 531.2 231.04 538.24 237.44l224 220.16C775.04 470.4 775.04 490.24 762.24 503.04z" p-id="3133" fill="#ffffff"></path></svg>
        </div>
        </body>
           <script>let titles = [{"title":"web前端绘图之canvas","id":"web前端绘图之canvas","index":2,"class":"bj224919","children":[{"title":"canvas标签","id":"canvas标签","index":3,"class":"LB573134","children":[{"title":"html部分","id":"html部分","index":4,"class":"Ki148014"},{"title":"js获取canvas画一个线","id":"js获取canvas画一个线","index":4,"class":"NF480274"},{"title":"效果","id":"效果","index":4,"class":"hF999340"}]},{"title":"矩形","id":"矩形","index":3,"class":"NG679826"},{"title":"圆","id":"圆","index":3,"class":"DA715644","children":[{"title":"例子","id":"例子","index":4,"class":"ac347557"},{"title":"效果","id":"效果","index":4,"class":"fZ462748"},{"title":"画饼图案例","id":"画饼图案例","index":4,"class":"GF829428"},{"title":"效果","id":"效果","index":4,"class":"DG397220"}]},{"title":"transform","id":"transform","index":3,"class":"XA025064","children":[{"title":"物体不按照中心旋转解决","id":"物体不按照中心旋转解决","index":4,"class":"GF437467"},{"title":"代码","id":"代码","index":4,"class":"Kg363682"},{"title":"效果显示","id":"效果显示","index":4,"class":"Dh887037"},{"title":"抽奖案例","id":"抽奖案例","index":4,"class":"Dg940671"},{"title":"效果","id":"效果","index":4,"class":"Mh435183"}]},{"title":"drawImage","id":"drawImage","index":3,"class":"bG722132","children":[{"title":"使用方法","id":"使用方法","index":4,"class":"cL974331"},{"title":"效果","id":"效果","index":4,"class":"AB450066"},{"title":"原图","id":"原图","index":4,"class":"CZ641542"}]},{"title":"canvas遮罩 -> globalCompositeOperation属性","id":"canvas遮罩 -> globalCompositeOperation属性","index":3,"class":"Gc876249","children":[{"title":"效果图","id":"效果图","index":4,"class":"eb812807"}]},{"title":"canvas操作像素点","id":"canvas操作像素点","index":3,"class":"GG985272","children":[{"title":"代码演示","id":"代码演示","index":4,"class":"HC917791"},{"title":"效果","id":"效果","index":4,"class":"NY935745"}]},{"title":"canvas转成base64传到服务器案例","id":"canvas转成base64传到服务器案例","index":3,"class":"Lh111400","children":[{"title":"屏幕手机适配","id":"屏幕手机适配","index":4,"class":"aC291852"},{"title":"小程序保存canvas","id":"小程序保存canvas","index":4,"class":"hF183621"},{"title":"canvas画字","id":"canvas画字","index":4,"class":"cN498651"}]}]}];</script>
           <script src="../index.js" type="text/javascript"></script>
           </html>
            